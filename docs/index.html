<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>kiteconnect API documentation</title>
    <meta name="description" content="Kite Connect API client for Python -- [https://kite.trade](kite.trade).

Zerodha technologies (c) 20..." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#kiteconnect.KiteConnect">KiteConnect</a></span>
        
          
  <ul>
    <li class="mono"><a href="#kiteconnect.KiteConnect.__init__">__init__</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.cancel_mf_order">cancel_mf_order</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.cancel_mf_sip">cancel_mf_sip</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.cancel_order">cancel_order</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.convert_position">convert_position</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.delete_gtt">delete_gtt</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.exit_order">exit_order</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.generate_session">generate_session</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.get_gtt">get_gtt</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.get_gtts">get_gtts</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.historical_data">historical_data</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.holdings">holdings</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.instruments">instruments</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.invalidate_access_token">invalidate_access_token</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.invalidate_refresh_token">invalidate_refresh_token</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.login_url">login_url</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.ltp">ltp</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.margins">margins</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.mf_holdings">mf_holdings</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.mf_instruments">mf_instruments</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.mf_orders">mf_orders</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.mf_sips">mf_sips</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.modify_gtt">modify_gtt</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.modify_mf_sip">modify_mf_sip</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.modify_order">modify_order</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.ohlc">ohlc</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.order_history">order_history</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.order_margins">order_margins</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.order_trades">order_trades</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.orders">orders</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.place_gtt">place_gtt</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.place_mf_order">place_mf_order</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.place_mf_sip">place_mf_sip</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.place_order">place_order</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.positions">positions</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.profile">profile</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.quote">quote</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.renew_access_token">renew_access_token</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.set_access_token">set_access_token</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.set_session_expiry_hook">set_session_expiry_hook</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.trades">trades</a></li>
    <li class="mono"><a href="#kiteconnect.KiteConnect.trigger_range">trigger_range</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#kiteconnect.KiteTicker">KiteTicker</a></span>
        
          
  <ul>
    <li class="mono"><a href="#kiteconnect.KiteTicker.__init__">__init__</a></li>
    <li class="mono"><a href="#kiteconnect.KiteTicker.close">close</a></li>
    <li class="mono"><a href="#kiteconnect.KiteTicker.connect">connect</a></li>
    <li class="mono"><a href="#kiteconnect.KiteTicker.is_connected">is_connected</a></li>
    <li class="mono"><a href="#kiteconnect.KiteTicker.resubscribe">resubscribe</a></li>
    <li class="mono"><a href="#kiteconnect.KiteTicker.set_mode">set_mode</a></li>
    <li class="mono"><a href="#kiteconnect.KiteTicker.stop">stop</a></li>
    <li class="mono"><a href="#kiteconnect.KiteTicker.stop_retry">stop_retry</a></li>
    <li class="mono"><a href="#kiteconnect.KiteTicker.subscribe">subscribe</a></li>
    <li class="mono"><a href="#kiteconnect.KiteTicker.unsubscribe">unsubscribe</a></li>
  </ul>

        </li>
      </ul>
    </li>

    <li class="set"><h3><a href="#header-submodules">Sub-modules</a></h3>
      <ul>
        <li class="mono"><a href="exceptions.m.html">kiteconnect.exceptions</a></li>
      </ul>
    </li>
    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">kiteconnect</span> module</h1>
  <p>Kite Connect API client for Python -- <a href="kite.trade">https://kite.trade</a>.</p>
<p>Zerodha technologies (c) 2018</p>
<h2>License</h2>
<p>KiteConnect Python library is licensed under the MIT License</p>
<h2>The library</h2>
<p>Kite Connect is a set of REST-like APIs that expose
many capabilities required to build a complete
investment and trading platform. Execute orders in
real time, manage user portfolio, stream live market
data (WebSockets), and more, with the simple HTTP API collection</p>
<p>This module provides an easy to use abstraction over the HTTP APIs.
The HTTP calls have been converted to methods and their JSON responses
are returned as native Python structures, for example, dicts, lists, bools etc.
See the <strong><a href="https://kite.trade/docs/connect/v3/">Kite Connect API documentation</a></strong>
for the complete list of APIs, supported parameters and values, and response formats.</p>
<h2>Getting started</h2>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">kiteconnect</span> <span class="kn">import</span> <span class="n">KiteConnect</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="n">kite</span> <span class="o">=</span> <span class="n">KiteConnect</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;your_api_key&quot;</span><span class="p">)</span>

<span class="c1"># Redirect the user to the login url obtained</span>
<span class="c1"># from kite.login_url(), and receive the request_token</span>
<span class="c1"># from the registered redirect url after the login flow.</span>
<span class="c1"># Once you have the request_token, obtain the access_token</span>
<span class="c1"># as follows.</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">kite</span><span class="o">.</span><span class="n">generate_session</span><span class="p">(</span><span class="s2">&quot;request_token_here&quot;</span><span class="p">,</span> <span class="n">api_secret</span><span class="o">=</span><span class="s2">&quot;your_secret&quot;</span><span class="p">)</span>
<span class="n">kite</span><span class="o">.</span><span class="n">set_access_token</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">])</span>

<span class="c1"># Place an order</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">order_id</span> <span class="o">=</span> <span class="n">kite</span><span class="o">.</span><span class="n">place_order</span><span class="p">(</span><span class="n">tradingsymbol</span><span class="o">=</span><span class="s2">&quot;INFY&quot;</span><span class="p">,</span>
                                <span class="n">exchange</span><span class="o">=</span><span class="n">kite</span><span class="o">.</span><span class="n">EXCHANGE_NSE</span><span class="p">,</span>
                                <span class="n">transaction_type</span><span class="o">=</span><span class="n">kite</span><span class="o">.</span><span class="n">TRANSACTION_TYPE_BUY</span><span class="p">,</span>
                                <span class="n">quantity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">order_type</span><span class="o">=</span><span class="n">kite</span><span class="o">.</span><span class="n">ORDER_TYPE_MARKET</span><span class="p">,</span>
                                <span class="n">product</span><span class="o">=</span><span class="n">kite</span><span class="o">.</span><span class="n">PRODUCT_NRML</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Order placed. ID is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">order_id</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Order placement failed: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">))</span>

<span class="c1"># Fetch all orders</span>
<span class="n">kite</span><span class="o">.</span><span class="n">orders</span><span class="p">()</span>

<span class="c1"># Get instruments</span>
<span class="n">kite</span><span class="o">.</span><span class="n">instruments</span><span class="p">()</span>

<span class="c1"># Place an mutual fund order</span>
<span class="n">kite</span><span class="o">.</span><span class="n">place_mf_order</span><span class="p">(</span>
    <span class="n">tradingsymbol</span><span class="o">=</span><span class="s2">&quot;INF090I01239&quot;</span><span class="p">,</span>
    <span class="n">transaction_type</span><span class="o">=</span><span class="n">kite</span><span class="o">.</span><span class="n">TRANSACTION_TYPE_BUY</span><span class="p">,</span>
    <span class="n">amount</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
    <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;mytag&quot;</span>
<span class="p">)</span>

<span class="c1"># Cancel a mutual fund order</span>
<span class="n">kite</span><span class="o">.</span><span class="n">cancel_mf_order</span><span class="p">(</span><span class="n">order_id</span><span class="o">=</span><span class="s2">&quot;order_id&quot;</span><span class="p">)</span>

<span class="c1"># Get mutual fund instruments</span>
<span class="n">kite</span><span class="o">.</span><span class="n">mf_instruments</span><span class="p">()</span>
</pre></div>


<h2>A typical web application</h2>
<p>In a typical web application where a new instance of
views, controllers etc. are created per incoming HTTP
request, you will need to initialise a new instance of
Kite client per request as well. This is because each
individual instance represents a single user that's
authenticated, unlike an <strong>admin</strong> API where you may
use one instance to manage many users.</p>
<p>Hence, in your web application, typically:</p>
<ul>
<li>You will initialise an instance of the Kite client</li>
<li>Redirect the user to the <code>login_url()</code></li>
<li>At the redirect url endpoint, obtain the
<code>request_token</code> from the query parameters</li>
<li>Initialise a new instance of Kite client,
use <code>generate_session()</code> to obtain the <code>access_token</code>
along with authenticated user data</li>
<li>Store this response in a session and use the
stored <code>access_token</code> and initialise instances
of Kite client for subsequent API calls.</li>
</ul>
<h2>Exceptions</h2>
<p>Kite Connect client saves you the hassle of detecting API errors
by looking at HTTP codes or JSON error responses. Instead,
it raises aptly named <strong><a href="exceptions.m.html">exceptions</a></strong> that you can catch.</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect" class="source">
    <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Kite Connect API client for Python -- [https://kite.trade](kite.trade).</span>

<span class="sd">Zerodha technologies (c) 2018</span>

<span class="sd">License</span>
<span class="sd">-------</span>
<span class="sd">KiteConnect Python library is licensed under the MIT License</span>

<span class="sd">The library</span>
<span class="sd">-----------</span>
<span class="sd">Kite Connect is a set of REST-like APIs that expose</span>
<span class="sd">many capabilities required to build a complete</span>
<span class="sd">investment and trading platform. Execute orders in</span>
<span class="sd">real time, manage user portfolio, stream live market</span>
<span class="sd">data (WebSockets), and more, with the simple HTTP API collection</span>

<span class="sd">This module provides an easy to use abstraction over the HTTP APIs.</span>
<span class="sd">The HTTP calls have been converted to methods and their JSON responses</span>
<span class="sd">are returned as native Python structures, for example, dicts, lists, bools etc.</span>
<span class="sd">See the **[Kite Connect API documentation](https://kite.trade/docs/connect/v3/)**</span>
<span class="sd">for the complete list of APIs, supported parameters and values, and response formats.</span>

<span class="sd">Getting started</span>
<span class="sd">---------------</span>
<span class="sd">    #!python</span>
<span class="sd">    import logging</span>
<span class="sd">    from kiteconnect import KiteConnect</span>

<span class="sd">    logging.basicConfig(level=logging.DEBUG)</span>

<span class="sd">    kite = KiteConnect(api_key=&quot;your_api_key&quot;)</span>

<span class="sd">    # Redirect the user to the login url obtained</span>
<span class="sd">    # from kite.login_url(), and receive the request_token</span>
<span class="sd">    # from the registered redirect url after the login flow.</span>
<span class="sd">    # Once you have the request_token, obtain the access_token</span>
<span class="sd">    # as follows.</span>

<span class="sd">    data = kite.generate_session(&quot;request_token_here&quot;, api_secret=&quot;your_secret&quot;)</span>
<span class="sd">    kite.set_access_token(data[&quot;access_token&quot;])</span>

<span class="sd">    # Place an order</span>
<span class="sd">    try:</span>
<span class="sd">        order_id = kite.place_order(tradingsymbol=&quot;INFY&quot;,</span>
<span class="sd">                                    exchange=kite.EXCHANGE_NSE,</span>
<span class="sd">                                    transaction_type=kite.TRANSACTION_TYPE_BUY,</span>
<span class="sd">                                    quantity=1,</span>
<span class="sd">                                    order_type=kite.ORDER_TYPE_MARKET,</span>
<span class="sd">                                    product=kite.PRODUCT_NRML)</span>

<span class="sd">        logging.info(&quot;Order placed. ID is: {}&quot;.format(order_id))</span>
<span class="sd">    except Exception as e:</span>
<span class="sd">        logging.info(&quot;Order placement failed: {}&quot;.format(e.message))</span>

<span class="sd">    # Fetch all orders</span>
<span class="sd">    kite.orders()</span>

<span class="sd">    # Get instruments</span>
<span class="sd">    kite.instruments()</span>

<span class="sd">    # Place an mutual fund order</span>
<span class="sd">    kite.place_mf_order(</span>
<span class="sd">        tradingsymbol=&quot;INF090I01239&quot;,</span>
<span class="sd">        transaction_type=kite.TRANSACTION_TYPE_BUY,</span>
<span class="sd">        amount=5000,</span>
<span class="sd">        tag=&quot;mytag&quot;</span>
<span class="sd">    )</span>

<span class="sd">    # Cancel a mutual fund order</span>
<span class="sd">    kite.cancel_mf_order(order_id=&quot;order_id&quot;)</span>

<span class="sd">    # Get mutual fund instruments</span>
<span class="sd">    kite.mf_instruments()</span>

<span class="sd">A typical web application</span>
<span class="sd">-------------------------</span>
<span class="sd">In a typical web application where a new instance of</span>
<span class="sd">views, controllers etc. are created per incoming HTTP</span>
<span class="sd">request, you will need to initialise a new instance of</span>
<span class="sd">Kite client per request as well. This is because each</span>
<span class="sd">individual instance represents a single user that&#39;s</span>
<span class="sd">authenticated, unlike an **admin** API where you may</span>
<span class="sd">use one instance to manage many users.</span>

<span class="sd">Hence, in your web application, typically:</span>

<span class="sd">- You will initialise an instance of the Kite client</span>
<span class="sd">- Redirect the user to the `login_url()`</span>
<span class="sd">- At the redirect url endpoint, obtain the</span>
<span class="sd">`request_token` from the query parameters</span>
<span class="sd">- Initialise a new instance of Kite client,</span>
<span class="sd">use `generate_session()` to obtain the `access_token`</span>
<span class="sd">along with authenticated user data</span>
<span class="sd">- Store this response in a session and use the</span>
<span class="sd">stored `access_token` and initialise instances</span>
<span class="sd">of Kite client for subsequent API calls.</span>

<span class="sd">Exceptions</span>
<span class="sd">----------</span>
<span class="sd">Kite Connect client saves you the hassle of detecting API errors</span>
<span class="sd">by looking at HTTP codes or JSON error responses. Instead,</span>
<span class="sd">it raises aptly named **[exceptions](exceptions.m.html)** that you can catch.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span><span class="p">,</span> <span class="n">absolute_import</span>

<span class="kn">from</span> <span class="nn">kiteconnect</span> <span class="kn">import</span> <span class="n">exceptions</span>
<span class="kn">from</span> <span class="nn">kiteconnect.connect</span> <span class="kn">import</span> <span class="n">KiteConnect</span>
<span class="kn">from</span> <span class="nn">kiteconnect.ticker</span> <span class="kn">import</span> <span class="n">KiteTicker</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;KiteConnect&quot;</span><span class="p">,</span> <span class="s2">&quot;KiteTicker&quot;</span><span class="p">,</span> <span class="s2">&quot;exceptions&quot;</span><span class="p">]</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="kiteconnect.KiteConnect" class="name">class <span class="ident">KiteConnect</span></p>
      
  
    <div class="desc"><p>The Kite Connect API wrapper class.</p>
<p>In production, you may initialise a single instance of this class per <code>api_key</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">KiteConnect</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Kite Connect API wrapper class.</span>

<span class="sd">    In production, you may initialise a single instance of this class per `api_key`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Default root API endpoint. It&#39;s possible to</span>
    <span class="c1"># override this by passing the `root` parameter during initialisation.</span>
    <span class="n">_default_root_uri</span> <span class="o">=</span> <span class="s2">&quot;https://api.kite.trade&quot;</span>
    <span class="n">_default_login_uri</span> <span class="o">=</span> <span class="s2">&quot;https://kite.trade/connect/login&quot;</span>
    <span class="n">_default_timeout</span> <span class="o">=</span> <span class="mi">7</span>  <span class="c1"># In seconds</span>

    <span class="c1"># Constants</span>
    <span class="c1"># Products</span>
    <span class="n">PRODUCT_MIS</span> <span class="o">=</span> <span class="s2">&quot;MIS&quot;</span>
    <span class="n">PRODUCT_CNC</span> <span class="o">=</span> <span class="s2">&quot;CNC&quot;</span>
    <span class="n">PRODUCT_NRML</span> <span class="o">=</span> <span class="s2">&quot;NRML&quot;</span>
    <span class="n">PRODUCT_CO</span> <span class="o">=</span> <span class="s2">&quot;CO&quot;</span>
    <span class="n">PRODUCT_BO</span> <span class="o">=</span> <span class="s2">&quot;BO&quot;</span>

    <span class="c1"># Order types</span>
    <span class="n">ORDER_TYPE_MARKET</span> <span class="o">=</span> <span class="s2">&quot;MARKET&quot;</span>
    <span class="n">ORDER_TYPE_LIMIT</span> <span class="o">=</span> <span class="s2">&quot;LIMIT&quot;</span>
    <span class="n">ORDER_TYPE_SLM</span> <span class="o">=</span> <span class="s2">&quot;SL-M&quot;</span>
    <span class="n">ORDER_TYPE_SL</span> <span class="o">=</span> <span class="s2">&quot;SL&quot;</span>

    <span class="c1"># Varities</span>
    <span class="n">VARIETY_REGULAR</span> <span class="o">=</span> <span class="s2">&quot;regular&quot;</span>
    <span class="n">VARIETY_BO</span> <span class="o">=</span> <span class="s2">&quot;bo&quot;</span>
    <span class="n">VARIETY_CO</span> <span class="o">=</span> <span class="s2">&quot;co&quot;</span>
    <span class="n">VARIETY_AMO</span> <span class="o">=</span> <span class="s2">&quot;amo&quot;</span>

    <span class="c1"># Transaction type</span>
    <span class="n">TRANSACTION_TYPE_BUY</span> <span class="o">=</span> <span class="s2">&quot;BUY&quot;</span>
    <span class="n">TRANSACTION_TYPE_SELL</span> <span class="o">=</span> <span class="s2">&quot;SELL&quot;</span>

    <span class="c1"># Validity</span>
    <span class="n">VALIDITY_DAY</span> <span class="o">=</span> <span class="s2">&quot;DAY&quot;</span>
    <span class="n">VALIDITY_IOC</span> <span class="o">=</span> <span class="s2">&quot;IOC&quot;</span>

    <span class="c1"># Position Type</span>
    <span class="n">POSITION_TYPE_DAY</span> <span class="o">=</span> <span class="s2">&quot;day&quot;</span>
    <span class="n">POSITION_TYPE_OVERNIGHT</span> <span class="o">=</span> <span class="s2">&quot;overnight&quot;</span>

    <span class="c1"># Exchanges</span>
    <span class="n">EXCHANGE_NSE</span> <span class="o">=</span> <span class="s2">&quot;NSE&quot;</span>
    <span class="n">EXCHANGE_BSE</span> <span class="o">=</span> <span class="s2">&quot;BSE&quot;</span>
    <span class="n">EXCHANGE_NFO</span> <span class="o">=</span> <span class="s2">&quot;NFO&quot;</span>
    <span class="n">EXCHANGE_CDS</span> <span class="o">=</span> <span class="s2">&quot;CDS&quot;</span>
    <span class="n">EXCHANGE_BFO</span> <span class="o">=</span> <span class="s2">&quot;BFO&quot;</span>
    <span class="n">EXCHANGE_MCX</span> <span class="o">=</span> <span class="s2">&quot;MCX&quot;</span>

    <span class="c1"># Margins segments</span>
    <span class="n">MARGIN_EQUITY</span> <span class="o">=</span> <span class="s2">&quot;equity&quot;</span>
    <span class="n">MARGIN_COMMODITY</span> <span class="o">=</span> <span class="s2">&quot;commodity&quot;</span>

    <span class="c1"># Status constants</span>
    <span class="n">STATUS_COMPLETE</span> <span class="o">=</span> <span class="s2">&quot;COMPLETE&quot;</span>
    <span class="n">STATUS_REJECTED</span> <span class="o">=</span> <span class="s2">&quot;REJECTED&quot;</span>
    <span class="n">STATUS_CANCELLED</span> <span class="o">=</span> <span class="s2">&quot;CANCELLED&quot;</span>

    <span class="c1"># GTT order type</span>
    <span class="n">GTT_TYPE_OCO</span> <span class="o">=</span> <span class="s2">&quot;two-leg&quot;</span>
    <span class="n">GTT_TYPE_SINGLE</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>

    <span class="c1"># GTT order status</span>
    <span class="n">GTT_STATUS_ACTIVE</span> <span class="o">=</span> <span class="s2">&quot;active&quot;</span>
    <span class="n">GTT_STATUS_TRIGGERED</span> <span class="o">=</span> <span class="s2">&quot;triggered&quot;</span>
    <span class="n">GTT_STATUS_DISABLED</span> <span class="o">=</span> <span class="s2">&quot;disabled&quot;</span>
    <span class="n">GTT_STATUS_EXPIRED</span> <span class="o">=</span> <span class="s2">&quot;expired&quot;</span>
    <span class="n">GTT_STATUS_CANCELLED</span> <span class="o">=</span> <span class="s2">&quot;cancelled&quot;</span>
    <span class="n">GTT_STATUS_REJECTED</span> <span class="o">=</span> <span class="s2">&quot;rejected&quot;</span>
    <span class="n">GTT_STATUS_DELETED</span> <span class="o">=</span> <span class="s2">&quot;deleted&quot;</span>

    <span class="c1"># URIs to various calls</span>
    <span class="n">_routes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;api.token&quot;</span><span class="p">:</span> <span class="s2">&quot;/session/token&quot;</span><span class="p">,</span>
        <span class="s2">&quot;api.token.invalidate&quot;</span><span class="p">:</span> <span class="s2">&quot;/session/token&quot;</span><span class="p">,</span>
        <span class="s2">&quot;api.token.renew&quot;</span><span class="p">:</span> <span class="s2">&quot;/session/refresh_token&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user.profile&quot;</span><span class="p">:</span> <span class="s2">&quot;/user/profile&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user.margins&quot;</span><span class="p">:</span> <span class="s2">&quot;/user/margins&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user.margins.segment&quot;</span><span class="p">:</span> <span class="s2">&quot;/user/margins/</span><span class="si">{segment}</span><span class="s2">&quot;</span><span class="p">,</span>

        <span class="s2">&quot;orders&quot;</span><span class="p">:</span> <span class="s2">&quot;/orders&quot;</span><span class="p">,</span>
        <span class="s2">&quot;trades&quot;</span><span class="p">:</span> <span class="s2">&quot;/trades&quot;</span><span class="p">,</span>

        <span class="s2">&quot;order.info&quot;</span><span class="p">:</span> <span class="s2">&quot;/orders/</span><span class="si">{order_id}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;order.place&quot;</span><span class="p">:</span> <span class="s2">&quot;/orders/</span><span class="si">{variety}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;order.modify&quot;</span><span class="p">:</span> <span class="s2">&quot;/orders/</span><span class="si">{variety}</span><span class="s2">/</span><span class="si">{order_id}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;order.cancel&quot;</span><span class="p">:</span> <span class="s2">&quot;/orders/</span><span class="si">{variety}</span><span class="s2">/</span><span class="si">{order_id}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;order.trades&quot;</span><span class="p">:</span> <span class="s2">&quot;/orders/</span><span class="si">{order_id}</span><span class="s2">/trades&quot;</span><span class="p">,</span>

        <span class="s2">&quot;portfolio.positions&quot;</span><span class="p">:</span> <span class="s2">&quot;/portfolio/positions&quot;</span><span class="p">,</span>
        <span class="s2">&quot;portfolio.holdings&quot;</span><span class="p">:</span> <span class="s2">&quot;/portfolio/holdings&quot;</span><span class="p">,</span>
        <span class="s2">&quot;portfolio.positions.convert&quot;</span><span class="p">:</span> <span class="s2">&quot;/portfolio/positions&quot;</span><span class="p">,</span>

        <span class="c1"># MF api endpoints</span>
        <span class="s2">&quot;mf.orders&quot;</span><span class="p">:</span> <span class="s2">&quot;/mf/orders&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mf.order.info&quot;</span><span class="p">:</span> <span class="s2">&quot;/mf/orders/</span><span class="si">{order_id}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mf.order.place&quot;</span><span class="p">:</span> <span class="s2">&quot;/mf/orders&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mf.order.cancel&quot;</span><span class="p">:</span> <span class="s2">&quot;/mf/orders/</span><span class="si">{order_id}</span><span class="s2">&quot;</span><span class="p">,</span>

        <span class="s2">&quot;mf.sips&quot;</span><span class="p">:</span> <span class="s2">&quot;/mf/sips&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mf.sip.info&quot;</span><span class="p">:</span> <span class="s2">&quot;/mf/sips/</span><span class="si">{sip_id}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mf.sip.place&quot;</span><span class="p">:</span> <span class="s2">&quot;/mf/sips&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mf.sip.modify&quot;</span><span class="p">:</span> <span class="s2">&quot;/mf/sips/</span><span class="si">{sip_id}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mf.sip.cancel&quot;</span><span class="p">:</span> <span class="s2">&quot;/mf/sips/</span><span class="si">{sip_id}</span><span class="s2">&quot;</span><span class="p">,</span>

        <span class="s2">&quot;mf.holdings&quot;</span><span class="p">:</span> <span class="s2">&quot;/mf/holdings&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mf.instruments&quot;</span><span class="p">:</span> <span class="s2">&quot;/mf/instruments&quot;</span><span class="p">,</span>

        <span class="s2">&quot;market.instruments.all&quot;</span><span class="p">:</span> <span class="s2">&quot;/instruments&quot;</span><span class="p">,</span>
        <span class="s2">&quot;market.instruments&quot;</span><span class="p">:</span> <span class="s2">&quot;/instruments/</span><span class="si">{exchange}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;market.margins&quot;</span><span class="p">:</span> <span class="s2">&quot;/margins/</span><span class="si">{segment}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;market.historical&quot;</span><span class="p">:</span> <span class="s2">&quot;/instruments/historical/</span><span class="si">{instrument_token}</span><span class="s2">/</span><span class="si">{interval}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;market.trigger_range&quot;</span><span class="p">:</span> <span class="s2">&quot;/instruments/trigger_range/</span><span class="si">{transaction_type}</span><span class="s2">&quot;</span><span class="p">,</span>

        <span class="s2">&quot;market.quote&quot;</span><span class="p">:</span> <span class="s2">&quot;/quote&quot;</span><span class="p">,</span>
        <span class="s2">&quot;market.quote.ohlc&quot;</span><span class="p">:</span> <span class="s2">&quot;/quote/ohlc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;market.quote.ltp&quot;</span><span class="p">:</span> <span class="s2">&quot;/quote/ltp&quot;</span><span class="p">,</span>

        <span class="c1"># GTT endpoints</span>
        <span class="s2">&quot;gtt&quot;</span><span class="p">:</span> <span class="s2">&quot;/gtt/triggers&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gtt.place&quot;</span><span class="p">:</span> <span class="s2">&quot;/gtt/triggers&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gtt.info&quot;</span><span class="p">:</span> <span class="s2">&quot;/gtt/triggers/</span><span class="si">{trigger_id}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gtt.modify&quot;</span><span class="p">:</span> <span class="s2">&quot;/gtt/triggers/</span><span class="si">{trigger_id}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gtt.delete&quot;</span><span class="p">:</span> <span class="s2">&quot;/gtt/triggers/</span><span class="si">{trigger_id}</span><span class="s2">&quot;</span><span class="p">,</span>

        <span class="c1"># Margin computation endpoints</span>
        <span class="s2">&quot;order.margins&quot;</span><span class="p">:</span> <span class="s2">&quot;/margins/orders&quot;</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">api_key</span><span class="p">,</span>
                 <span class="n">access_token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">root</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">proxies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">pool</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">disable_ssl</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise a new Kite Connect client instance.</span>

<span class="sd">        - `api_key` is the key issued to you</span>
<span class="sd">        - `access_token` is the token obtained after the login flow in</span>
<span class="sd">            exchange for the `request_token` . Pre-login, this will default to None,</span>
<span class="sd">        but once you have obtained it, you should</span>
<span class="sd">        persist it in a database or session to pass</span>
<span class="sd">        to the Kite Connect class initialisation for subsequent requests.</span>
<span class="sd">        - `root` is the API end point root. Unless you explicitly</span>
<span class="sd">        want to send API requests to a non-default endpoint, this</span>
<span class="sd">        can be ignored.</span>
<span class="sd">        - `debug`, if set to True, will serialise and print requests</span>
<span class="sd">        and responses to stdout.</span>
<span class="sd">        - `timeout` is the time (seconds) for which the API client will wait for</span>
<span class="sd">        a request to complete before it fails. Defaults to 7 seconds</span>
<span class="sd">        - `proxies` to set requests proxy.</span>
<span class="sd">        Check [python requests documentation](http://docs.python-requests.org/en/master/user/advanced/#proxies) for usage and examples.</span>
<span class="sd">        - `pool` is manages request pools. It takes a dict of params accepted by HTTPAdapter as described here in [python requests documentation](http://docs.python-requests.org/en/master/api/#requests.adapters.HTTPAdapter)</span>
<span class="sd">        - `disable_ssl` disables the SSL verification while making a request.</span>
<span class="sd">        If set requests won&#39;t throw SSLError if its set to custom `root` url without SSL.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">api_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session_expiry_hook</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disable_ssl</span> <span class="o">=</span> <span class="n">disable_ssl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="n">access_token</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxies</span> <span class="o">=</span> <span class="n">proxies</span> <span class="k">if</span> <span class="n">proxies</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_root_uri</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_timeout</span>

        <span class="c1"># Create requests session only if pool exists. Reuse session</span>
        <span class="c1"># for every request. Otherwise create session for each request</span>
        <span class="k">if</span> <span class="n">pool</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reqsession</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
            <span class="n">reqadapter</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">adapters</span><span class="o">.</span><span class="n">HTTPAdapter</span><span class="p">(</span><span class="o">**</span><span class="n">pool</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reqsession</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s2">&quot;https://&quot;</span><span class="p">,</span> <span class="n">reqadapter</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reqsession</span> <span class="o">=</span> <span class="n">requests</span>

        <span class="c1"># disable requests SSL warning</span>
        <span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">set_session_expiry_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a callback hook for session (`TokenError` -- timeout, expiry etc.) errors.</span>

<span class="sd">        An `access_token` (login session) can become invalid for a number of</span>
<span class="sd">        reasons, but it doesn&#39;t make sense for the client to</span>
<span class="sd">        try and catch it during every API call.</span>

<span class="sd">        A callback method that handles session errors</span>
<span class="sd">        can be set here and when the client encounters</span>
<span class="sd">        a token error at any point, it&#39;ll be called.</span>

<span class="sd">        This callback, for instance, can log the user out of the UI,</span>
<span class="sd">        clear session cookies, or initiate a fresh login.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid input type. Only functions are accepted.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">session_expiry_hook</span> <span class="o">=</span> <span class="n">method</span>

    <span class="k">def</span> <span class="nf">set_access_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">access_token</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the `access_token` received after a successful authentication.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="n">access_token</span>

    <span class="k">def</span> <span class="nf">login_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the remote login url to which a user should be redirected to initiate the login flow.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">?api_key=</span><span class="si">%s</span><span class="s2">&amp;v=3&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_login_uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_token</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate user session details like `access_token` etc by exchanging `request_token`.</span>
<span class="sd">        Access token is automatically set if the session is retrieved successfully.</span>

<span class="sd">        Do the token exchange with the `request_token` obtained after the login flow,</span>
<span class="sd">        and retrieve the `access_token` required for all subsequent requests. The</span>
<span class="sd">        response contains not just the `access_token`, but metadata for</span>
<span class="sd">        the user who has authenticated.</span>

<span class="sd">        - `request_token` is the token obtained from the GET paramers after a successful login redirect.</span>
<span class="sd">        - `api_secret` is the API api_secret issued with the API key.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">request_token</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">api_secret</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
        <span class="n">checksum</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;api.token&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;api_key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">,</span>
            <span class="s2">&quot;request_token&quot;</span><span class="p">:</span> <span class="n">request_token</span><span class="p">,</span>
            <span class="s2">&quot;checksum&quot;</span><span class="p">:</span> <span class="n">checksum</span>
        <span class="p">})</span>

        <span class="k">if</span> <span class="s2">&quot;access_token&quot;</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_access_token</span><span class="p">(</span><span class="n">resp</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">resp</span><span class="p">[</span><span class="s2">&quot;login_time&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">resp</span><span class="p">[</span><span class="s2">&quot;login_time&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">19</span><span class="p">:</span>
            <span class="n">resp</span><span class="p">[</span><span class="s2">&quot;login_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateutil</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">[</span><span class="s2">&quot;login_time&quot;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">resp</span>

    <span class="k">def</span> <span class="nf">invalidate_access_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Kill the session by invalidating the access token.</span>

<span class="sd">        - `access_token` to invalidate. Default is the active `access_token`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">access_token</span> <span class="o">=</span> <span class="n">access_token</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_token</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="s2">&quot;api.token.invalidate&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;api_key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">,</span>
            <span class="s2">&quot;access_token&quot;</span><span class="p">:</span> <span class="n">access_token</span>
        <span class="p">})</span>

    <span class="k">def</span> <span class="nf">renew_access_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renew expired `refresh_token` using valid `refresh_token`.</span>

<span class="sd">        - `refresh_token` is the token obtained from previous successful login flow.</span>
<span class="sd">        - `api_secret` is the API api_secret issued with the API key.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">refresh_token</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">api_secret</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
        <span class="n">checksum</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;api.token.renew&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;api_key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">,</span>
            <span class="s2">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="n">refresh_token</span><span class="p">,</span>
            <span class="s2">&quot;checksum&quot;</span><span class="p">:</span> <span class="n">checksum</span>
        <span class="p">})</span>

        <span class="k">if</span> <span class="s2">&quot;access_token&quot;</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_access_token</span><span class="p">(</span><span class="n">resp</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">resp</span>

    <span class="k">def</span> <span class="nf">invalidate_refresh_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalidate refresh token.</span>

<span class="sd">        - `refresh_token` is the token which is used to renew access token.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="s2">&quot;api.token.invalidate&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;api_key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">,</span>
            <span class="s2">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="n">refresh_token</span>
        <span class="p">})</span>

    <span class="k">def</span> <span class="nf">margins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get account balance and cash margin details for a particular segment.</span>

<span class="sd">        - `segment` is the trading segment (eg: equity or commodity)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">segment</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;user.margins.segment&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;segment&quot;</span><span class="p">:</span> <span class="n">segment</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;user.margins&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get user profile details.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;user.profile&quot;</span><span class="p">)</span>

    <span class="c1"># orders</span>
    <span class="k">def</span> <span class="nf">place_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">variety</span><span class="p">,</span>
                    <span class="n">exchange</span><span class="p">,</span>
                    <span class="n">tradingsymbol</span><span class="p">,</span>
                    <span class="n">transaction_type</span><span class="p">,</span>
                    <span class="n">quantity</span><span class="p">,</span>
                    <span class="n">product</span><span class="p">,</span>
                    <span class="n">order_type</span><span class="p">,</span>
                    <span class="n">price</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">validity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">disclosed_quantity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">trigger_price</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">squareoff</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">stoploss</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">trailing_stoploss</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Place an order.&quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        <span class="k">del</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;self&quot;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">del</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;order.place&quot;</span><span class="p">,</span>
                          <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;variety&quot;</span><span class="p">:</span> <span class="n">variety</span><span class="p">},</span>
                          <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)[</span><span class="s2">&quot;order_id&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">modify_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">variety</span><span class="p">,</span>
                     <span class="n">order_id</span><span class="p">,</span>
                     <span class="n">parent_order_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">quantity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">price</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">order_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">trigger_price</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">validity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">disclosed_quantity</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modify an open order.&quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        <span class="k">del</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;self&quot;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">del</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put</span><span class="p">(</span><span class="s2">&quot;order.modify&quot;</span><span class="p">,</span>
                         <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;variety&quot;</span><span class="p">:</span> <span class="n">variety</span><span class="p">,</span> <span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="n">order_id</span><span class="p">},</span>
                         <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)[</span><span class="s2">&quot;order_id&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">cancel_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variety</span><span class="p">,</span> <span class="n">order_id</span><span class="p">,</span> <span class="n">parent_order_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cancel an order.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="s2">&quot;order.cancel&quot;</span><span class="p">,</span>
                            <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;variety&quot;</span><span class="p">:</span> <span class="n">variety</span><span class="p">,</span> <span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="n">order_id</span><span class="p">},</span>
                            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;parent_order_id&quot;</span><span class="p">:</span> <span class="n">parent_order_id</span><span class="p">})[</span><span class="s2">&quot;order_id&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">exit_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variety</span><span class="p">,</span> <span class="n">order_id</span><span class="p">,</span> <span class="n">parent_order_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Exit a BO/CO order.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cancel_order</span><span class="p">(</span><span class="n">variety</span><span class="p">,</span> <span class="n">order_id</span><span class="p">,</span> <span class="n">parent_order_id</span><span class="o">=</span><span class="n">parent_order_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse and format responses.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">_list</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="n">_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">_list</span><span class="p">:</span>
            <span class="c1"># Convert date time string to datetime object</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;order_timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;exchange_timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;created&quot;</span><span class="p">,</span> <span class="s2">&quot;last_instalment&quot;</span><span class="p">,</span> <span class="s2">&quot;fill_timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;last_trade_time&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="n">field</span><span class="p">])</span> <span class="o">==</span> <span class="mi">19</span><span class="p">:</span>
                    <span class="n">item</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateutil</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="n">field</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span> <span class="k">else</span> <span class="n">_list</span>

    <span class="c1"># orderbook and tradebook</span>
    <span class="k">def</span> <span class="nf">orders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get list of orders.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;orders&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">order_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get history of individual order.</span>

<span class="sd">        - `order_id` is the ID of the order to retrieve order history.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;order.info&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="n">order_id</span><span class="p">}))</span>

    <span class="k">def</span> <span class="nf">trades</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve the list of trades executed (all or ones under a particular order).</span>

<span class="sd">        An order can be executed in tranches based on market conditions.</span>
<span class="sd">        These trades are individually recorded under an order.</span>

<span class="sd">        - `order_id` is the ID of the order (optional) whose trades are to be retrieved.</span>
<span class="sd">        If no `order_id` is specified, all trades for the day are returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;trades&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">order_trades</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve the list of trades executed for a particular order.</span>

<span class="sd">        - `order_id` is the ID of the order (optional) whose trades are to be retrieved.</span>
<span class="sd">            If no `order_id` is specified, all trades for the day are returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;order.trades&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="n">order_id</span><span class="p">}))</span>

    <span class="k">def</span> <span class="nf">positions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the list of positions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;portfolio.positions&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">holdings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the list of equity holdings.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;portfolio.holdings&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">convert_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">exchange</span><span class="p">,</span>
                         <span class="n">tradingsymbol</span><span class="p">,</span>
                         <span class="n">transaction_type</span><span class="p">,</span>
                         <span class="n">position_type</span><span class="p">,</span>
                         <span class="n">quantity</span><span class="p">,</span>
                         <span class="n">old_product</span><span class="p">,</span>
                         <span class="n">new_product</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modify an open position&#39;s product type.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put</span><span class="p">(</span><span class="s2">&quot;portfolio.positions.convert&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;exchange&quot;</span><span class="p">:</span> <span class="n">exchange</span><span class="p">,</span>
            <span class="s2">&quot;tradingsymbol&quot;</span><span class="p">:</span> <span class="n">tradingsymbol</span><span class="p">,</span>
            <span class="s2">&quot;transaction_type&quot;</span><span class="p">:</span> <span class="n">transaction_type</span><span class="p">,</span>
            <span class="s2">&quot;position_type&quot;</span><span class="p">:</span> <span class="n">position_type</span><span class="p">,</span>
            <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="n">quantity</span><span class="p">,</span>
            <span class="s2">&quot;old_product&quot;</span><span class="p">:</span> <span class="n">old_product</span><span class="p">,</span>
            <span class="s2">&quot;new_product&quot;</span><span class="p">:</span> <span class="n">new_product</span>
        <span class="p">})</span>

    <span class="k">def</span> <span class="nf">mf_orders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get all mutual fund orders or individual order info.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">order_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;mf.order.info&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="n">order_id</span><span class="p">}))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;mf.orders&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">place_mf_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">tradingsymbol</span><span class="p">,</span>
                       <span class="n">transaction_type</span><span class="p">,</span>
                       <span class="n">quantity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">amount</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Place a mutual fund order.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;mf.order.place&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;tradingsymbol&quot;</span><span class="p">:</span> <span class="n">tradingsymbol</span><span class="p">,</span>
            <span class="s2">&quot;transaction_type&quot;</span><span class="p">:</span> <span class="n">transaction_type</span><span class="p">,</span>
            <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="n">quantity</span><span class="p">,</span>
            <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
            <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="n">tag</span>
        <span class="p">})</span>

    <span class="k">def</span> <span class="nf">cancel_mf_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cancel a mutual fund order.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="s2">&quot;mf.order.cancel&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="n">order_id</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">mf_sips</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sip_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get list of all mutual fund SIP&#39;s or individual SIP info.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">sip_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;mf.sip.info&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sip_id&quot;</span><span class="p">:</span> <span class="n">sip_id</span><span class="p">}))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;mf.sips&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">place_mf_sip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">tradingsymbol</span><span class="p">,</span>
                     <span class="n">amount</span><span class="p">,</span>
                     <span class="n">instalments</span><span class="p">,</span>
                     <span class="n">frequency</span><span class="p">,</span>
                     <span class="n">initial_amount</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">instalment_day</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Place a mutual fund SIP.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;mf.sip.place&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;tradingsymbol&quot;</span><span class="p">:</span> <span class="n">tradingsymbol</span><span class="p">,</span>
            <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
            <span class="s2">&quot;initial_amount&quot;</span><span class="p">:</span> <span class="n">initial_amount</span><span class="p">,</span>
            <span class="s2">&quot;instalments&quot;</span><span class="p">:</span> <span class="n">instalments</span><span class="p">,</span>
            <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="n">frequency</span><span class="p">,</span>
            <span class="s2">&quot;instalment_day&quot;</span><span class="p">:</span> <span class="n">instalment_day</span><span class="p">,</span>
            <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="n">tag</span>
        <span class="p">})</span>

    <span class="k">def</span> <span class="nf">modify_mf_sip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                      <span class="n">sip_id</span><span class="p">,</span>
                      <span class="n">amount</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">instalments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">frequency</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">instalment_day</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modify a mutual fund SIP.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put</span><span class="p">(</span><span class="s2">&quot;mf.sip.modify&quot;</span><span class="p">,</span>
                         <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sip_id&quot;</span><span class="p">:</span> <span class="n">sip_id</span><span class="p">},</span>
                         <span class="n">params</span><span class="o">=</span><span class="p">{</span>
                             <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
                             <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">status</span><span class="p">,</span>
                             <span class="s2">&quot;instalments&quot;</span><span class="p">:</span> <span class="n">instalments</span><span class="p">,</span>
                             <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="n">frequency</span><span class="p">,</span>
                             <span class="s2">&quot;instalment_day&quot;</span><span class="p">:</span> <span class="n">instalment_day</span>
                         <span class="p">})</span>

    <span class="k">def</span> <span class="nf">cancel_mf_sip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sip_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cancel a mutual fund SIP.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="s2">&quot;mf.sip.cancel&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sip_id&quot;</span><span class="p">:</span> <span class="n">sip_id</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">mf_holdings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get list of mutual fund holdings.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;mf.holdings&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mf_instruments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get list of mutual fund instruments.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_mf_instruments</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;mf.instruments&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">instruments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve the list of market instruments available to trade.</span>

<span class="sd">        Note that the results could be large, several hundred KBs in size,</span>
<span class="sd">        with tens of thousands of entries in the list.</span>

<span class="sd">        - `exchange` is specific exchange to fetch (Optional)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">exchange</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_instruments</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.instruments&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;exchange&quot;</span><span class="p">:</span> <span class="n">exchange</span><span class="p">}))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_instruments</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.instruments.all&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">quote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">instruments</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve quote for list of instruments.</span>

<span class="sd">        - `instruments` is a list of instruments, Instrument are in the format of `exchange:tradingsymbol`. For example NSE:INFY</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ins</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span>

        <span class="c1"># If first element is a list then accept it as instruments list for legacy reason</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">ins</span> <span class="o">=</span> <span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.quote&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="n">ins</span><span class="p">})</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">ohlc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">instruments</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve OHLC and market depth for list of instruments.</span>

<span class="sd">        - `instruments` is a list of instruments, Instrument are in the format of `exchange:tradingsymbol`. For example NSE:INFY</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ins</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span>

        <span class="c1"># If first element is a list then accept it as instruments list for legacy reason</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">ins</span> <span class="o">=</span> <span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.quote.ohlc&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="n">ins</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">ltp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">instruments</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve last price for list of instruments.</span>

<span class="sd">        - `instruments` is a list of instruments, Instrument are in the format of `exchange:tradingsymbol`. For example NSE:INFY</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ins</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span>

        <span class="c1"># If first element is a list then accept it as instruments list for legacy reason</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">ins</span> <span class="o">=</span> <span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.quote.ltp&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="n">ins</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">historical_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instrument_token</span><span class="p">,</span> <span class="n">from_date</span><span class="p">,</span> <span class="n">to_date</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">continuous</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">oi</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve historical data (candles) for an instrument.</span>

<span class="sd">        Although the actual response JSON from the API does not have field</span>
<span class="sd">        names such has &#39;open&#39;, &#39;high&#39; etc., this function call structures</span>
<span class="sd">        the data into an array of objects with field names. For example:</span>

<span class="sd">        - `instrument_token` is the instrument identifier (retrieved from the instruments()) call.</span>
<span class="sd">        - `from_date` is the From date (datetime object or string in format of yyyy-mm-dd HH:MM:SS.</span>
<span class="sd">        - `to_date` is the To date (datetime object or string in format of yyyy-mm-dd HH:MM:SS).</span>
<span class="sd">        - `interval` is the candle interval (minute, day, 5 minute etc.).</span>
<span class="sd">        - `continuous` is a boolean flag to get continuous data for futures and options instruments.</span>
<span class="sd">        - `oi` is a boolean flag to get open interest.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">date_string_format</span> <span class="o">=</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span>
        <span class="n">from_date_string</span> <span class="o">=</span> <span class="n">from_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">date_string_format</span><span class="p">)</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">from_date</span><span class="p">)</span> <span class="o">==</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="k">else</span> <span class="n">from_date</span>
        <span class="n">to_date_string</span> <span class="o">=</span> <span class="n">to_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">date_string_format</span><span class="p">)</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_date</span><span class="p">)</span> <span class="o">==</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="k">else</span> <span class="n">to_date</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.historical&quot;</span><span class="p">,</span>
                         <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;instrument_token&quot;</span><span class="p">:</span> <span class="n">instrument_token</span><span class="p">,</span> <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="n">interval</span><span class="p">},</span>
                         <span class="n">params</span><span class="o">=</span><span class="p">{</span>
                             <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="n">from_date_string</span><span class="p">,</span>
                             <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="n">to_date_string</span><span class="p">,</span>
                             <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="n">interval</span><span class="p">,</span>
                             <span class="s2">&quot;continuous&quot;</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">continuous</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
                             <span class="s2">&quot;oi&quot;</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">oi</span> <span class="k">else</span> <span class="mi">0</span>
                         <span class="p">})</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_historical</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_format_historical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;candles&quot;</span><span class="p">]:</span>
            <span class="n">record</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">dateutil</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                <span class="s2">&quot;open&quot;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                <span class="s2">&quot;close&quot;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                <span class="s2">&quot;volume&quot;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
                <span class="n">record</span><span class="p">[</span><span class="s2">&quot;oi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
            <span class="n">records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">records</span>

    <span class="k">def</span> <span class="nf">trigger_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction_type</span><span class="p">,</span> <span class="o">*</span><span class="n">instruments</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the buy/sell trigger range for Cover Orders.&quot;&quot;&quot;</span>
        <span class="n">ins</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span>

        <span class="c1"># If first element is a list then accept it as instruments list for legacy reason</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">ins</span> <span class="o">=</span> <span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.trigger_range&quot;</span><span class="p">,</span>
                         <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;transaction_type&quot;</span><span class="p">:</span> <span class="n">transaction_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()},</span>
                         <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="n">ins</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">get_gtts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fetch list of gtt existing in an account&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;gtt&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_gtt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fetch details of a GTT&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;gtt.info&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;trigger_id&quot;</span><span class="p">:</span> <span class="n">trigger_id</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">_get_gtt_payload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger_type</span><span class="p">,</span> <span class="n">tradingsymbol</span><span class="p">,</span> <span class="n">exchange</span><span class="p">,</span> <span class="n">trigger_values</span><span class="p">,</span> <span class="n">last_price</span><span class="p">,</span> <span class="n">orders</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get GTT payload&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">trigger_values</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ex</span><span class="o">.</span><span class="n">InputException</span><span class="p">(</span><span class="s2">&quot;invalid type for `trigger_values`&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">trigger_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">GTT_TYPE_SINGLE</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">trigger_values</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ex</span><span class="o">.</span><span class="n">InputException</span><span class="p">(</span><span class="s2">&quot;invalid `trigger_values` for single leg order type&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">trigger_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">GTT_TYPE_OCO</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">trigger_values</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ex</span><span class="o">.</span><span class="n">InputException</span><span class="p">(</span><span class="s2">&quot;invalid `trigger_values` for OCO order type&quot;</span><span class="p">)</span>

        <span class="n">condition</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;exchange&quot;</span><span class="p">:</span> <span class="n">exchange</span><span class="p">,</span>
            <span class="s2">&quot;tradingsymbol&quot;</span><span class="p">:</span> <span class="n">tradingsymbol</span><span class="p">,</span>
            <span class="s2">&quot;trigger_values&quot;</span><span class="p">:</span> <span class="n">trigger_values</span><span class="p">,</span>
            <span class="s2">&quot;last_price&quot;</span><span class="p">:</span> <span class="n">last_price</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">gtt_orders</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orders</span><span class="p">:</span>
            <span class="c1"># Assert required keys inside gtt order.</span>
            <span class="k">for</span> <span class="n">req</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;transaction_type&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;order_type&quot;</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">req</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">o</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ex</span><span class="o">.</span><span class="n">InputException</span><span class="p">(</span><span class="s2">&quot;`</span><span class="si">{req}</span><span class="s2">` missing inside orders&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">req</span><span class="o">=</span><span class="n">req</span><span class="p">))</span>
            <span class="n">gtt_orders</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s2">&quot;exchange&quot;</span><span class="p">:</span> <span class="n">exchange</span><span class="p">,</span>
                <span class="s2">&quot;tradingsymbol&quot;</span><span class="p">:</span> <span class="n">tradingsymbol</span><span class="p">,</span>
                <span class="s2">&quot;transaction_type&quot;</span><span class="p">:</span> <span class="n">o</span><span class="p">[</span><span class="s2">&quot;transaction_type&quot;</span><span class="p">],</span>
                <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">o</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]),</span>
                <span class="s2">&quot;order_type&quot;</span><span class="p">:</span> <span class="n">o</span><span class="p">[</span><span class="s2">&quot;order_type&quot;</span><span class="p">],</span>
                <span class="s2">&quot;product&quot;</span><span class="p">:</span> <span class="n">o</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">],</span>
                <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">o</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]),</span>
            <span class="p">})</span>

        <span class="k">return</span> <span class="n">condition</span><span class="p">,</span> <span class="n">gtt_orders</span>

    <span class="k">def</span> <span class="nf">place_gtt</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">trigger_type</span><span class="p">,</span> <span class="n">tradingsymbol</span><span class="p">,</span> <span class="n">exchange</span><span class="p">,</span> <span class="n">trigger_values</span><span class="p">,</span> <span class="n">last_price</span><span class="p">,</span> <span class="n">orders</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Place GTT order</span>

<span class="sd">        - `trigger_type` The type of GTT order(single/two-leg).</span>
<span class="sd">        - `tradingsymbol` Trading symbol of the instrument.</span>
<span class="sd">        - `exchange` Name of the exchange.</span>
<span class="sd">        - `trigger_values` Trigger values (json array).</span>
<span class="sd">        - `last_price` Last price of the instrument at the time of order placement.</span>
<span class="sd">        - `orders` JSON order array containing following fields</span>
<span class="sd">            - `transaction_type` BUY or SELL</span>
<span class="sd">            - `quantity` Quantity to transact</span>
<span class="sd">            - `price` The min or max price to execute the order at (for LIMIT orders)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validations.</span>
        <span class="k">assert</span> <span class="n">trigger_type</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">GTT_TYPE_OCO</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GTT_TYPE_SINGLE</span><span class="p">]</span>
        <span class="n">condition</span><span class="p">,</span> <span class="n">gtt_orders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_gtt_payload</span><span class="p">(</span><span class="n">trigger_type</span><span class="p">,</span> <span class="n">tradingsymbol</span><span class="p">,</span> <span class="n">exchange</span><span class="p">,</span> <span class="n">trigger_values</span><span class="p">,</span> <span class="n">last_price</span><span class="p">,</span> <span class="n">orders</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;gtt.place&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;condition&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">condition</span><span class="p">),</span>
            <span class="s2">&quot;orders&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">gtt_orders</span><span class="p">),</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">trigger_type</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">modify_gtt</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">trigger_id</span><span class="p">,</span> <span class="n">trigger_type</span><span class="p">,</span> <span class="n">tradingsymbol</span><span class="p">,</span> <span class="n">exchange</span><span class="p">,</span> <span class="n">trigger_values</span><span class="p">,</span> <span class="n">last_price</span><span class="p">,</span> <span class="n">orders</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modify GTT order</span>

<span class="sd">        - `trigger_type` The type of GTT order(single/two-leg).</span>
<span class="sd">        - `tradingsymbol` Trading symbol of the instrument.</span>
<span class="sd">        - `exchange` Name of the exchange.</span>
<span class="sd">        - `trigger_values` Trigger values (json array).</span>
<span class="sd">        - `last_price` Last price of the instrument at the time of order placement.</span>
<span class="sd">        - `orders` JSON order array containing following fields</span>
<span class="sd">            - `transaction_type` BUY or SELL</span>
<span class="sd">            - `quantity` Quantity to transact</span>
<span class="sd">            - `price` The min or max price to execute the order at (for LIMIT orders)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">condition</span><span class="p">,</span> <span class="n">gtt_orders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_gtt_payload</span><span class="p">(</span><span class="n">trigger_type</span><span class="p">,</span> <span class="n">tradingsymbol</span><span class="p">,</span> <span class="n">exchange</span><span class="p">,</span> <span class="n">trigger_values</span><span class="p">,</span> <span class="n">last_price</span><span class="p">,</span> <span class="n">orders</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put</span><span class="p">(</span><span class="s2">&quot;gtt.modify&quot;</span><span class="p">,</span>
                         <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;trigger_id&quot;</span><span class="p">:</span> <span class="n">trigger_id</span><span class="p">},</span>
                         <span class="n">params</span><span class="o">=</span><span class="p">{</span>
                             <span class="s2">&quot;condition&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">condition</span><span class="p">),</span>
                             <span class="s2">&quot;orders&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">gtt_orders</span><span class="p">),</span>
                             <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">trigger_type</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">delete_gtt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a GTT order.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="s2">&quot;gtt.delete&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;trigger_id&quot;</span><span class="p">:</span> <span class="n">trigger_id</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">order_margins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate margins for requested order list considering the existing positions and open orders</span>

<span class="sd">        - `params` is list of orders to retrive margins detail</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;order.margins&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">is_json</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_instruments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="c1"># decode to string for Python 3</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">data</span>
        <span class="c1"># Decode unicode data</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">PY2</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bytes</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;instrument_token&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;instrument_token&quot;</span><span class="p">])</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;last_price&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;last_price&quot;</span><span class="p">])</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;strike&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;strike&quot;</span><span class="p">])</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;tick_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;tick_size&quot;</span><span class="p">])</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;lot_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;lot_size&quot;</span><span class="p">])</span>

            <span class="c1"># Parse date</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;expiry&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
                <span class="n">row</span><span class="p">[</span><span class="s2">&quot;expiry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateutil</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;expiry&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>

            <span class="n">records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">records</span>

    <span class="k">def</span> <span class="nf">_parse_mf_instruments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="c1"># decode to string for Python 3</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">PY2</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bytes</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;minimum_purchase_amount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;minimum_purchase_amount&quot;</span><span class="p">])</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;purchase_amount_multiplier&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;purchase_amount_multiplier&quot;</span><span class="p">])</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;minimum_additional_purchase_amount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;minimum_additional_purchase_amount&quot;</span><span class="p">])</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;minimum_redemption_quantity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;minimum_redemption_quantity&quot;</span><span class="p">])</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;redemption_quantity_multiplier&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;redemption_quantity_multiplier&quot;</span><span class="p">])</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;purchase_allowed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;purchase_allowed&quot;</span><span class="p">]))</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;redemption_allowed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;redemption_allowed&quot;</span><span class="p">]))</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;last_price&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;last_price&quot;</span><span class="p">])</span>

            <span class="c1"># Parse date</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;last_price_date&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
                <span class="n">row</span><span class="p">[</span><span class="s2">&quot;last_price_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateutil</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;last_price_date&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>

            <span class="n">records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">records</span>

    <span class="k">def</span> <span class="nf">_user_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">__title__</span> <span class="o">+</span> <span class="s2">&quot;-python/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="o">+</span> <span class="n">__version__</span>

    <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">route</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_json</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alias for sending a GET request.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="n">route</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="n">url_args</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">is_json</span><span class="o">=</span><span class="n">is_json</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">route</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_json</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alias for sending a POST request.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="n">route</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="n">url_args</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">is_json</span><span class="o">=</span><span class="n">is_json</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">route</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_json</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alias for sending a PUT request.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="n">route</span><span class="p">,</span> <span class="s2">&quot;PUT&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="n">url_args</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">is_json</span><span class="o">=</span><span class="n">is_json</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">route</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_json</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alias for sending a DELETE request.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="n">route</span><span class="p">,</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="n">url_args</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">is_json</span><span class="o">=</span><span class="n">is_json</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">route</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_json</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make an HTTP request.&quot;&quot;&quot;</span>
        <span class="c1"># Form a restful URL</span>
        <span class="k">if</span> <span class="n">url_args</span><span class="p">:</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_routes</span><span class="p">[</span><span class="n">route</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">url_args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_routes</span><span class="p">[</span><span class="n">route</span><span class="p">]</span>

        <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">uri</span><span class="p">)</span>

        <span class="c1"># Custom headers</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;X-Kite-Version&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>  <span class="c1"># For version 3</span>
            <span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_agent</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_token</span><span class="p">:</span>
            <span class="c1"># set authorization header</span>
            <span class="n">auth_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_token</span>
            <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Authorization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;token </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">auth_header</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Request: </span><span class="si">{method}</span><span class="s2"> </span><span class="si">{url}</span><span class="s2"> </span><span class="si">{params}</span><span class="s2"> </span><span class="si">{headers}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reqsession</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span>
                                        <span class="n">url</span><span class="p">,</span>
                                        <span class="n">json</span><span class="o">=</span><span class="n">params</span> <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="s2">&quot;PUT&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">is_json</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                                        <span class="n">data</span><span class="o">=</span><span class="n">params</span> <span class="k">if</span> <span class="p">(</span><span class="n">method</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="s2">&quot;PUT&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_json</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                                        <span class="n">params</span><span class="o">=</span><span class="n">params</span> <span class="k">if</span> <span class="n">method</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                                        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
                                        <span class="n">verify</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">disable_ssl</span><span class="p">,</span>
                                        <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span>
                                        <span class="n">proxies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proxies</span><span class="p">)</span>
        <span class="c1"># Any requests lib related exceptions are raised here - http://docs.python-requests.org/en/master/_modules/requests/exceptions/</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Response: </span><span class="si">{code}</span><span class="s2"> </span><span class="si">{content}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>

        <span class="c1"># Validate the content type.</span>
        <span class="k">if</span> <span class="s2">&quot;json&quot;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;content-type&quot;</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ex</span><span class="o">.</span><span class="n">DataException</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t parse the JSON response received from the server: </span><span class="si">{content}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">content</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>

            <span class="c1"># api error</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;error_type&quot;</span><span class="p">):</span>
                <span class="c1"># Call session hook if its registered and TokenException is raised</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">session_expiry_hook</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;error_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;TokenException&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">session_expiry_hook</span><span class="p">()</span>

                <span class="c1"># native Kite errors</span>
                <span class="n">exp</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;error_type&quot;</span><span class="p">],</span> <span class="n">ex</span><span class="o">.</span><span class="n">GeneralException</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">exp</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;message&quot;</span><span class="p">],</span> <span class="n">code</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;csv&quot;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;content-type&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">content</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ex</span><span class="o">.</span><span class="n">DataException</span><span class="p">(</span><span class="s2">&quot;Unknown Content-Type (</span><span class="si">{content_type}</span><span class="s2">) with response: (</span><span class="si">{content}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">content_type</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;content-type&quot;</span><span class="p">],</span>
                <span class="n">content</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#kiteconnect.KiteConnect">KiteConnect</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="kiteconnect.KiteConnect.EXCHANGE_BFO" class="name">var <span class="ident">EXCHANGE_BFO</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.EXCHANGE_BSE" class="name">var <span class="ident">EXCHANGE_BSE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.EXCHANGE_CDS" class="name">var <span class="ident">EXCHANGE_CDS</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.EXCHANGE_MCX" class="name">var <span class="ident">EXCHANGE_MCX</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.EXCHANGE_NFO" class="name">var <span class="ident">EXCHANGE_NFO</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.EXCHANGE_NSE" class="name">var <span class="ident">EXCHANGE_NSE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.GTT_STATUS_ACTIVE" class="name">var <span class="ident">GTT_STATUS_ACTIVE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.GTT_STATUS_CANCELLED" class="name">var <span class="ident">GTT_STATUS_CANCELLED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.GTT_STATUS_DELETED" class="name">var <span class="ident">GTT_STATUS_DELETED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.GTT_STATUS_DISABLED" class="name">var <span class="ident">GTT_STATUS_DISABLED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.GTT_STATUS_EXPIRED" class="name">var <span class="ident">GTT_STATUS_EXPIRED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.GTT_STATUS_REJECTED" class="name">var <span class="ident">GTT_STATUS_REJECTED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.GTT_STATUS_TRIGGERED" class="name">var <span class="ident">GTT_STATUS_TRIGGERED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.GTT_TYPE_OCO" class="name">var <span class="ident">GTT_TYPE_OCO</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.GTT_TYPE_SINGLE" class="name">var <span class="ident">GTT_TYPE_SINGLE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.MARGIN_COMMODITY" class="name">var <span class="ident">MARGIN_COMMODITY</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.MARGIN_EQUITY" class="name">var <span class="ident">MARGIN_EQUITY</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.ORDER_TYPE_LIMIT" class="name">var <span class="ident">ORDER_TYPE_LIMIT</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.ORDER_TYPE_MARKET" class="name">var <span class="ident">ORDER_TYPE_MARKET</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.ORDER_TYPE_SL" class="name">var <span class="ident">ORDER_TYPE_SL</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.ORDER_TYPE_SLM" class="name">var <span class="ident">ORDER_TYPE_SLM</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.POSITION_TYPE_DAY" class="name">var <span class="ident">POSITION_TYPE_DAY</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.POSITION_TYPE_OVERNIGHT" class="name">var <span class="ident">POSITION_TYPE_OVERNIGHT</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.PRODUCT_BO" class="name">var <span class="ident">PRODUCT_BO</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.PRODUCT_CNC" class="name">var <span class="ident">PRODUCT_CNC</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.PRODUCT_CO" class="name">var <span class="ident">PRODUCT_CO</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.PRODUCT_MIS" class="name">var <span class="ident">PRODUCT_MIS</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.PRODUCT_NRML" class="name">var <span class="ident">PRODUCT_NRML</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.STATUS_CANCELLED" class="name">var <span class="ident">STATUS_CANCELLED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.STATUS_COMPLETE" class="name">var <span class="ident">STATUS_COMPLETE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.STATUS_REJECTED" class="name">var <span class="ident">STATUS_REJECTED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.TRANSACTION_TYPE_BUY" class="name">var <span class="ident">TRANSACTION_TYPE_BUY</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.TRANSACTION_TYPE_SELL" class="name">var <span class="ident">TRANSACTION_TYPE_SELL</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.VALIDITY_DAY" class="name">var <span class="ident">VALIDITY_DAY</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.VALIDITY_IOC" class="name">var <span class="ident">VALIDITY_IOC</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.VARIETY_AMO" class="name">var <span class="ident">VARIETY_AMO</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.VARIETY_BO" class="name">var <span class="ident">VARIETY_BO</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.VARIETY_CO" class="name">var <span class="ident">VARIETY_CO</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.VARIETY_REGULAR" class="name">var <span class="ident">VARIETY_REGULAR</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, api_key, access_token=None, root=None, debug=False, timeout=None, proxies=None, pool=None, disable_ssl=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialise a new Kite Connect client instance.</p>
<ul>
<li><code>api_key</code> is the key issued to you</li>
<li><code>access_token</code> is the token obtained after the login flow in
    exchange for the <code>request_token</code> . Pre-login, this will default to None,
but once you have obtained it, you should
persist it in a database or session to pass
to the Kite Connect class initialisation for subsequent requests.</li>
<li><code>root</code> is the API end point root. Unless you explicitly
want to send API requests to a non-default endpoint, this
can be ignored.</li>
<li><code>debug</code>, if set to True, will serialise and print requests
and responses to stdout.</li>
<li><code>timeout</code> is the time (seconds) for which the API client will wait for
a request to complete before it fails. Defaults to 7 seconds</li>
<li><code>proxies</code> to set requests proxy.
Check <a href="http://docs.python-requests.org/en/master/user/advanced/#proxies">python requests documentation</a> for usage and examples.</li>
<li><code>pool</code> is manages request pools. It takes a dict of params accepted by HTTPAdapter as described here in <a href="http://docs.python-requests.org/en/master/api/#requests.adapters.HTTPAdapter">python requests documentation</a></li>
<li><code>disable_ssl</code> disables the SSL verification while making a request.
If set requests won't throw SSLError if its set to custom <code>root</code> url without SSL.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.__init__', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">api_key</span><span class="p">,</span>
             <span class="n">access_token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">root</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">proxies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">pool</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">disable_ssl</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialise a new Kite Connect client instance.</span>
<span class="sd">    - `api_key` is the key issued to you</span>
<span class="sd">    - `access_token` is the token obtained after the login flow in</span>
<span class="sd">        exchange for the `request_token` . Pre-login, this will default to None,</span>
<span class="sd">    but once you have obtained it, you should</span>
<span class="sd">    persist it in a database or session to pass</span>
<span class="sd">    to the Kite Connect class initialisation for subsequent requests.</span>
<span class="sd">    - `root` is the API end point root. Unless you explicitly</span>
<span class="sd">    want to send API requests to a non-default endpoint, this</span>
<span class="sd">    can be ignored.</span>
<span class="sd">    - `debug`, if set to True, will serialise and print requests</span>
<span class="sd">    and responses to stdout.</span>
<span class="sd">    - `timeout` is the time (seconds) for which the API client will wait for</span>
<span class="sd">    a request to complete before it fails. Defaults to 7 seconds</span>
<span class="sd">    - `proxies` to set requests proxy.</span>
<span class="sd">    Check [python requests documentation](http://docs.python-requests.org/en/master/user/advanced/#proxies) for usage and examples.</span>
<span class="sd">    - `pool` is manages request pools. It takes a dict of params accepted by HTTPAdapter as described here in [python requests documentation](http://docs.python-requests.org/en/master/api/#requests.adapters.HTTPAdapter)</span>
<span class="sd">    - `disable_ssl` disables the SSL verification while making a request.</span>
<span class="sd">    If set requests won&#39;t throw SSLError if its set to custom `root` url without SSL.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">api_key</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">session_expiry_hook</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">disable_ssl</span> <span class="o">=</span> <span class="n">disable_ssl</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="n">access_token</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">proxies</span> <span class="o">=</span> <span class="n">proxies</span> <span class="k">if</span> <span class="n">proxies</span> <span class="k">else</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_root_uri</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_timeout</span>
    <span class="c1"># Create requests session only if pool exists. Reuse session</span>
    <span class="c1"># for every request. Otherwise create session for each request</span>
    <span class="k">if</span> <span class="n">pool</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reqsession</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
        <span class="n">reqadapter</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">adapters</span><span class="o">.</span><span class="n">HTTPAdapter</span><span class="p">(</span><span class="o">**</span><span class="n">pool</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reqsession</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s2">&quot;https://&quot;</span><span class="p">,</span> <span class="n">reqadapter</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reqsession</span> <span class="o">=</span> <span class="n">requests</span>
    <span class="c1"># disable requests SSL warning</span>
    <span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.cancel_mf_order">
    <p>def <span class="ident">cancel_mf_order</span>(</p><p>self, order_id)</p>
    </div>
    

    
  
    <div class="desc"><p>Cancel a mutual fund order.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.cancel_mf_order', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.cancel_mf_order" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cancel_mf_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cancel a mutual fund order.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="s2">&quot;mf.order.cancel&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="n">order_id</span><span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.cancel_mf_sip">
    <p>def <span class="ident">cancel_mf_sip</span>(</p><p>self, sip_id)</p>
    </div>
    

    
  
    <div class="desc"><p>Cancel a mutual fund SIP.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.cancel_mf_sip', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.cancel_mf_sip" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cancel_mf_sip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sip_id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cancel a mutual fund SIP.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="s2">&quot;mf.sip.cancel&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sip_id&quot;</span><span class="p">:</span> <span class="n">sip_id</span><span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.cancel_order">
    <p>def <span class="ident">cancel_order</span>(</p><p>self, variety, order_id, parent_order_id=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Cancel an order.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.cancel_order', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.cancel_order" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cancel_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variety</span><span class="p">,</span> <span class="n">order_id</span><span class="p">,</span> <span class="n">parent_order_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cancel an order.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="s2">&quot;order.cancel&quot;</span><span class="p">,</span>
                        <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;variety&quot;</span><span class="p">:</span> <span class="n">variety</span><span class="p">,</span> <span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="n">order_id</span><span class="p">},</span>
                        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;parent_order_id&quot;</span><span class="p">:</span> <span class="n">parent_order_id</span><span class="p">})[</span><span class="s2">&quot;order_id&quot;</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.convert_position">
    <p>def <span class="ident">convert_position</span>(</p><p>self, exchange, tradingsymbol, transaction_type, position_type, quantity, old_product, new_product)</p>
    </div>
    

    
  
    <div class="desc"><p>Modify an open position's product type.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.convert_position', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.convert_position" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">convert_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">exchange</span><span class="p">,</span>
                     <span class="n">tradingsymbol</span><span class="p">,</span>
                     <span class="n">transaction_type</span><span class="p">,</span>
                     <span class="n">position_type</span><span class="p">,</span>
                     <span class="n">quantity</span><span class="p">,</span>
                     <span class="n">old_product</span><span class="p">,</span>
                     <span class="n">new_product</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Modify an open position&#39;s product type.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put</span><span class="p">(</span><span class="s2">&quot;portfolio.positions.convert&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;exchange&quot;</span><span class="p">:</span> <span class="n">exchange</span><span class="p">,</span>
        <span class="s2">&quot;tradingsymbol&quot;</span><span class="p">:</span> <span class="n">tradingsymbol</span><span class="p">,</span>
        <span class="s2">&quot;transaction_type&quot;</span><span class="p">:</span> <span class="n">transaction_type</span><span class="p">,</span>
        <span class="s2">&quot;position_type&quot;</span><span class="p">:</span> <span class="n">position_type</span><span class="p">,</span>
        <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="n">quantity</span><span class="p">,</span>
        <span class="s2">&quot;old_product&quot;</span><span class="p">:</span> <span class="n">old_product</span><span class="p">,</span>
        <span class="s2">&quot;new_product&quot;</span><span class="p">:</span> <span class="n">new_product</span>
    <span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.delete_gtt">
    <p>def <span class="ident">delete_gtt</span>(</p><p>self, trigger_id)</p>
    </div>
    

    
  
    <div class="desc"><p>Delete a GTT order.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.delete_gtt', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.delete_gtt" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_gtt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger_id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete a GTT order.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="s2">&quot;gtt.delete&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;trigger_id&quot;</span><span class="p">:</span> <span class="n">trigger_id</span><span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.exit_order">
    <p>def <span class="ident">exit_order</span>(</p><p>self, variety, order_id, parent_order_id=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Exit a BO/CO order.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.exit_order', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.exit_order" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">exit_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variety</span><span class="p">,</span> <span class="n">order_id</span><span class="p">,</span> <span class="n">parent_order_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Exit a BO/CO order.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cancel_order</span><span class="p">(</span><span class="n">variety</span><span class="p">,</span> <span class="n">order_id</span><span class="p">,</span> <span class="n">parent_order_id</span><span class="o">=</span><span class="n">parent_order_id</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.generate_session">
    <p>def <span class="ident">generate_session</span>(</p><p>self, request_token, api_secret)</p>
    </div>
    

    
  
    <div class="desc"><p>Generate user session details like <code>access_token</code> etc by exchanging <code>request_token</code>.
Access token is automatically set if the session is retrieved successfully.</p>
<p>Do the token exchange with the <code>request_token</code> obtained after the login flow,
and retrieve the <code>access_token</code> required for all subsequent requests. The
response contains not just the <code>access_token</code>, but metadata for
the user who has authenticated.</p>
<ul>
<li><code>request_token</code> is the token obtained from the GET paramers after a successful login redirect.</li>
<li><code>api_secret</code> is the API api_secret issued with the API key.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.generate_session', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.generate_session" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">generate_session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_token</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate user session details like `access_token` etc by exchanging `request_token`.</span>
<span class="sd">    Access token is automatically set if the session is retrieved successfully.</span>
<span class="sd">    Do the token exchange with the `request_token` obtained after the login flow,</span>
<span class="sd">    and retrieve the `access_token` required for all subsequent requests. The</span>
<span class="sd">    response contains not just the `access_token`, but metadata for</span>
<span class="sd">    the user who has authenticated.</span>
<span class="sd">    - `request_token` is the token obtained from the GET paramers after a successful login redirect.</span>
<span class="sd">    - `api_secret` is the API api_secret issued with the API key.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">request_token</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">api_secret</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
    <span class="n">checksum</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;api.token&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;api_key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">,</span>
        <span class="s2">&quot;request_token&quot;</span><span class="p">:</span> <span class="n">request_token</span><span class="p">,</span>
        <span class="s2">&quot;checksum&quot;</span><span class="p">:</span> <span class="n">checksum</span>
    <span class="p">})</span>
    <span class="k">if</span> <span class="s2">&quot;access_token&quot;</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_access_token</span><span class="p">(</span><span class="n">resp</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">resp</span><span class="p">[</span><span class="s2">&quot;login_time&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">resp</span><span class="p">[</span><span class="s2">&quot;login_time&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">19</span><span class="p">:</span>
        <span class="n">resp</span><span class="p">[</span><span class="s2">&quot;login_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateutil</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">resp</span><span class="p">[</span><span class="s2">&quot;login_time&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">resp</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.get_gtt">
    <p>def <span class="ident">get_gtt</span>(</p><p>self, trigger_id)</p>
    </div>
    

    
  
    <div class="desc"><p>Fetch details of a GTT</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.get_gtt', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.get_gtt" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_gtt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger_id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fetch details of a GTT&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;gtt.info&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;trigger_id&quot;</span><span class="p">:</span> <span class="n">trigger_id</span><span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.get_gtts">
    <p>def <span class="ident">get_gtts</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Fetch list of gtt existing in an account</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.get_gtts', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.get_gtts" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_gtts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fetch list of gtt existing in an account&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;gtt&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.historical_data">
    <p>def <span class="ident">historical_data</span>(</p><p>self, instrument_token, from_date, to_date, interval, continuous=False, oi=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Retrieve historical data (candles) for an instrument.</p>
<p>Although the actual response JSON from the API does not have field
names such has 'open', 'high' etc., this function call structures
the data into an array of objects with field names. For example:</p>
<ul>
<li><code>instrument_token</code> is the instrument identifier (retrieved from the instruments()) call.</li>
<li><code>from_date</code> is the From date (datetime object or string in format of yyyy-mm-dd HH:MM:SS.</li>
<li><code>to_date</code> is the To date (datetime object or string in format of yyyy-mm-dd HH:MM:SS).</li>
<li><code>interval</code> is the candle interval (minute, day, 5 minute etc.).</li>
<li><code>continuous</code> is a boolean flag to get continuous data for futures and options instruments.</li>
<li><code>oi</code> is a boolean flag to get open interest.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.historical_data', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.historical_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">historical_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instrument_token</span><span class="p">,</span> <span class="n">from_date</span><span class="p">,</span> <span class="n">to_date</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">continuous</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">oi</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve historical data (candles) for an instrument.</span>
<span class="sd">    Although the actual response JSON from the API does not have field</span>
<span class="sd">    names such has &#39;open&#39;, &#39;high&#39; etc., this function call structures</span>
<span class="sd">    the data into an array of objects with field names. For example:</span>
<span class="sd">    - `instrument_token` is the instrument identifier (retrieved from the instruments()) call.</span>
<span class="sd">    - `from_date` is the From date (datetime object or string in format of yyyy-mm-dd HH:MM:SS.</span>
<span class="sd">    - `to_date` is the To date (datetime object or string in format of yyyy-mm-dd HH:MM:SS).</span>
<span class="sd">    - `interval` is the candle interval (minute, day, 5 minute etc.).</span>
<span class="sd">    - `continuous` is a boolean flag to get continuous data for futures and options instruments.</span>
<span class="sd">    - `oi` is a boolean flag to get open interest.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">date_string_format</span> <span class="o">=</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span>
    <span class="n">from_date_string</span> <span class="o">=</span> <span class="n">from_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">date_string_format</span><span class="p">)</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">from_date</span><span class="p">)</span> <span class="o">==</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="k">else</span> <span class="n">from_date</span>
    <span class="n">to_date_string</span> <span class="o">=</span> <span class="n">to_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">date_string_format</span><span class="p">)</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_date</span><span class="p">)</span> <span class="o">==</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="k">else</span> <span class="n">to_date</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.historical&quot;</span><span class="p">,</span>
                     <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;instrument_token&quot;</span><span class="p">:</span> <span class="n">instrument_token</span><span class="p">,</span> <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="n">interval</span><span class="p">},</span>
                     <span class="n">params</span><span class="o">=</span><span class="p">{</span>
                         <span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="n">from_date_string</span><span class="p">,</span>
                         <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="n">to_date_string</span><span class="p">,</span>
                         <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="n">interval</span><span class="p">,</span>
                         <span class="s2">&quot;continuous&quot;</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">continuous</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
                         <span class="s2">&quot;oi&quot;</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">oi</span> <span class="k">else</span> <span class="mi">0</span>
                     <span class="p">})</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_historical</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.holdings">
    <p>def <span class="ident">holdings</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Retrieve the list of equity holdings.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.holdings', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.holdings" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">holdings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Retrieve the list of equity holdings.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;portfolio.holdings&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.instruments">
    <p>def <span class="ident">instruments</span>(</p><p>self, exchange=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Retrieve the list of market instruments available to trade.</p>
<p>Note that the results could be large, several hundred KBs in size,
with tens of thousands of entries in the list.</p>
<ul>
<li><code>exchange</code> is specific exchange to fetch (Optional)</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.instruments', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.instruments" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">instruments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve the list of market instruments available to trade.</span>
<span class="sd">    Note that the results could be large, several hundred KBs in size,</span>
<span class="sd">    with tens of thousands of entries in the list.</span>
<span class="sd">    - `exchange` is specific exchange to fetch (Optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">exchange</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_instruments</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.instruments&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;exchange&quot;</span><span class="p">:</span> <span class="n">exchange</span><span class="p">}))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_instruments</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.instruments.all&quot;</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.invalidate_access_token">
    <p>def <span class="ident">invalidate_access_token</span>(</p><p>self, access_token=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Kill the session by invalidating the access token.</p>
<ul>
<li><code>access_token</code> to invalidate. Default is the active <code>access_token</code>.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.invalidate_access_token', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.invalidate_access_token" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">invalidate_access_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">access_token</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kill the session by invalidating the access token.</span>
<span class="sd">    - `access_token` to invalidate. Default is the active `access_token`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">access_token</span> <span class="o">=</span> <span class="n">access_token</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_token</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="s2">&quot;api.token.invalidate&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;api_key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">,</span>
        <span class="s2">&quot;access_token&quot;</span><span class="p">:</span> <span class="n">access_token</span>
    <span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.invalidate_refresh_token">
    <p>def <span class="ident">invalidate_refresh_token</span>(</p><p>self, refresh_token)</p>
    </div>
    

    
  
    <div class="desc"><p>Invalidate refresh token.</p>
<ul>
<li><code>refresh_token</code> is the token which is used to renew access token.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.invalidate_refresh_token', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.invalidate_refresh_token" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">invalidate_refresh_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Invalidate refresh token.</span>
<span class="sd">    - `refresh_token` is the token which is used to renew access token.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="s2">&quot;api.token.invalidate&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;api_key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">,</span>
        <span class="s2">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="n">refresh_token</span>
    <span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.login_url">
    <p>def <span class="ident">login_url</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the remote login url to which a user should be redirected to initiate the login flow.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.login_url', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.login_url" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">login_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the remote login url to which a user should be redirected to initiate the login flow.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">?api_key=</span><span class="si">%s</span><span class="s2">&amp;v=3&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_login_uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.ltp">
    <p>def <span class="ident">ltp</span>(</p><p>self, *instruments)</p>
    </div>
    

    
  
    <div class="desc"><p>Retrieve last price for list of instruments.</p>
<ul>
<li><code>instruments</code> is a list of instruments, Instrument are in the format of <code>exchange:tradingsymbol</code>. For example NSE:INFY</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.ltp', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.ltp" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ltp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">instruments</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve last price for list of instruments.</span>
<span class="sd">    - `instruments` is a list of instruments, Instrument are in the format of `exchange:tradingsymbol`. For example NSE:INFY</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ins</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span>
    <span class="c1"># If first element is a list then accept it as instruments list for legacy reason</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">ins</span> <span class="o">=</span> <span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.quote.ltp&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="n">ins</span><span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.margins">
    <p>def <span class="ident">margins</span>(</p><p>self, segment=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get account balance and cash margin details for a particular segment.</p>
<ul>
<li><code>segment</code> is the trading segment (eg: equity or commodity)</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.margins', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.margins" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">margins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get account balance and cash margin details for a particular segment.</span>
<span class="sd">    - `segment` is the trading segment (eg: equity or commodity)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">segment</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;user.margins.segment&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;segment&quot;</span><span class="p">:</span> <span class="n">segment</span><span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;user.margins&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.mf_holdings">
    <p>def <span class="ident">mf_holdings</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Get list of mutual fund holdings.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.mf_holdings', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.mf_holdings" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">mf_holdings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get list of mutual fund holdings.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;mf.holdings&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.mf_instruments">
    <p>def <span class="ident">mf_instruments</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Get list of mutual fund instruments.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.mf_instruments', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.mf_instruments" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">mf_instruments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get list of mutual fund instruments.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_mf_instruments</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;mf.instruments&quot;</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.mf_orders">
    <p>def <span class="ident">mf_orders</span>(</p><p>self, order_id=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get all mutual fund orders or individual order info.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.mf_orders', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.mf_orders" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">mf_orders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get all mutual fund orders or individual order info.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">order_id</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;mf.order.info&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="n">order_id</span><span class="p">}))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;mf.orders&quot;</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.mf_sips">
    <p>def <span class="ident">mf_sips</span>(</p><p>self, sip_id=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Get list of all mutual fund SIP's or individual SIP info.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.mf_sips', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.mf_sips" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">mf_sips</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sip_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get list of all mutual fund SIP&#39;s or individual SIP info.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">sip_id</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;mf.sip.info&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sip_id&quot;</span><span class="p">:</span> <span class="n">sip_id</span><span class="p">}))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;mf.sips&quot;</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.modify_gtt">
    <p>def <span class="ident">modify_gtt</span>(</p><p>self, trigger_id, trigger_type, tradingsymbol, exchange, trigger_values, last_price, orders)</p>
    </div>
    

    
  
    <div class="desc"><p>Modify GTT order</p>
<ul>
<li><code>trigger_type</code> The type of GTT order(single/two-leg).</li>
<li><code>tradingsymbol</code> Trading symbol of the instrument.</li>
<li><code>exchange</code> Name of the exchange.</li>
<li><code>trigger_values</code> Trigger values (json array).</li>
<li><code>last_price</code> Last price of the instrument at the time of order placement.</li>
<li><code>orders</code> JSON order array containing following fields<ul>
<li><code>transaction_type</code> BUY or SELL</li>
<li><code>quantity</code> Quantity to transact</li>
<li><code>price</code> The min or max price to execute the order at (for LIMIT orders)</li>
</ul>
</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.modify_gtt', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.modify_gtt" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">modify_gtt</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">trigger_id</span><span class="p">,</span> <span class="n">trigger_type</span><span class="p">,</span> <span class="n">tradingsymbol</span><span class="p">,</span> <span class="n">exchange</span><span class="p">,</span> <span class="n">trigger_values</span><span class="p">,</span> <span class="n">last_price</span><span class="p">,</span> <span class="n">orders</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modify GTT order</span>
<span class="sd">    - `trigger_type` The type of GTT order(single/two-leg).</span>
<span class="sd">    - `tradingsymbol` Trading symbol of the instrument.</span>
<span class="sd">    - `exchange` Name of the exchange.</span>
<span class="sd">    - `trigger_values` Trigger values (json array).</span>
<span class="sd">    - `last_price` Last price of the instrument at the time of order placement.</span>
<span class="sd">    - `orders` JSON order array containing following fields</span>
<span class="sd">        - `transaction_type` BUY or SELL</span>
<span class="sd">        - `quantity` Quantity to transact</span>
<span class="sd">        - `price` The min or max price to execute the order at (for LIMIT orders)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">condition</span><span class="p">,</span> <span class="n">gtt_orders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_gtt_payload</span><span class="p">(</span><span class="n">trigger_type</span><span class="p">,</span> <span class="n">tradingsymbol</span><span class="p">,</span> <span class="n">exchange</span><span class="p">,</span> <span class="n">trigger_values</span><span class="p">,</span> <span class="n">last_price</span><span class="p">,</span> <span class="n">orders</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put</span><span class="p">(</span><span class="s2">&quot;gtt.modify&quot;</span><span class="p">,</span>
                     <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;trigger_id&quot;</span><span class="p">:</span> <span class="n">trigger_id</span><span class="p">},</span>
                     <span class="n">params</span><span class="o">=</span><span class="p">{</span>
                         <span class="s2">&quot;condition&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">condition</span><span class="p">),</span>
                         <span class="s2">&quot;orders&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">gtt_orders</span><span class="p">),</span>
                         <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">trigger_type</span><span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.modify_mf_sip">
    <p>def <span class="ident">modify_mf_sip</span>(</p><p>self, sip_id, amount=None, status=None, instalments=None, frequency=None, instalment_day=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Modify a mutual fund SIP.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.modify_mf_sip', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.modify_mf_sip" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">modify_mf_sip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                  <span class="n">sip_id</span><span class="p">,</span>
                  <span class="n">amount</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">instalments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">frequency</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">instalment_day</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Modify a mutual fund SIP.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put</span><span class="p">(</span><span class="s2">&quot;mf.sip.modify&quot;</span><span class="p">,</span>
                     <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sip_id&quot;</span><span class="p">:</span> <span class="n">sip_id</span><span class="p">},</span>
                     <span class="n">params</span><span class="o">=</span><span class="p">{</span>
                         <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
                         <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">status</span><span class="p">,</span>
                         <span class="s2">&quot;instalments&quot;</span><span class="p">:</span> <span class="n">instalments</span><span class="p">,</span>
                         <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="n">frequency</span><span class="p">,</span>
                         <span class="s2">&quot;instalment_day&quot;</span><span class="p">:</span> <span class="n">instalment_day</span>
                     <span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.modify_order">
    <p>def <span class="ident">modify_order</span>(</p><p>self, variety, order_id, parent_order_id=None, quantity=None, price=None, order_type=None, trigger_price=None, validity=None, disclosed_quantity=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Modify an open order.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.modify_order', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.modify_order" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">modify_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">variety</span><span class="p">,</span>
                 <span class="n">order_id</span><span class="p">,</span>
                 <span class="n">parent_order_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">quantity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">price</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">order_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">trigger_price</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">validity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">disclosed_quantity</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Modify an open order.&quot;&quot;&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
    <span class="k">del</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;self&quot;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">del</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put</span><span class="p">(</span><span class="s2">&quot;order.modify&quot;</span><span class="p">,</span>
                     <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;variety&quot;</span><span class="p">:</span> <span class="n">variety</span><span class="p">,</span> <span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="n">order_id</span><span class="p">},</span>
                     <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)[</span><span class="s2">&quot;order_id&quot;</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.ohlc">
    <p>def <span class="ident">ohlc</span>(</p><p>self, *instruments)</p>
    </div>
    

    
  
    <div class="desc"><p>Retrieve OHLC and market depth for list of instruments.</p>
<ul>
<li><code>instruments</code> is a list of instruments, Instrument are in the format of <code>exchange:tradingsymbol</code>. For example NSE:INFY</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.ohlc', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.ohlc" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ohlc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">instruments</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve OHLC and market depth for list of instruments.</span>
<span class="sd">    - `instruments` is a list of instruments, Instrument are in the format of `exchange:tradingsymbol`. For example NSE:INFY</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ins</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span>
    <span class="c1"># If first element is a list then accept it as instruments list for legacy reason</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">ins</span> <span class="o">=</span> <span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.quote.ohlc&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="n">ins</span><span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.order_history">
    <p>def <span class="ident">order_history</span>(</p><p>self, order_id)</p>
    </div>
    

    
  
    <div class="desc"><p>Get history of individual order.</p>
<ul>
<li><code>order_id</code> is the ID of the order to retrieve order history.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.order_history', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.order_history" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">order_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get history of individual order.</span>
<span class="sd">    - `order_id` is the ID of the order to retrieve order history.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;order.info&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="n">order_id</span><span class="p">}))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.order_margins">
    <p>def <span class="ident">order_margins</span>(</p><p>self, params)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate margins for requested order list considering the existing positions and open orders</p>
<ul>
<li><code>params</code> is list of orders to retrive margins detail</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.order_margins', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.order_margins" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">order_margins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate margins for requested order list considering the existing positions and open orders</span>
<span class="sd">    - `params` is list of orders to retrive margins detail</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;order.margins&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">is_json</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.order_trades">
    <p>def <span class="ident">order_trades</span>(</p><p>self, order_id)</p>
    </div>
    

    
  
    <div class="desc"><p>Retrieve the list of trades executed for a particular order.</p>
<ul>
<li><code>order_id</code> is the ID of the order (optional) whose trades are to be retrieved.
    If no <code>order_id</code> is specified, all trades for the day are returned.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.order_trades', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.order_trades" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">order_trades</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve the list of trades executed for a particular order.</span>
<span class="sd">    - `order_id` is the ID of the order (optional) whose trades are to be retrieved.</span>
<span class="sd">        If no `order_id` is specified, all trades for the day are returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;order.trades&quot;</span><span class="p">,</span> <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="n">order_id</span><span class="p">}))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.orders">
    <p>def <span class="ident">orders</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Get list of orders.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.orders', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.orders" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">orders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get list of orders.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;orders&quot;</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.place_gtt">
    <p>def <span class="ident">place_gtt</span>(</p><p>self, trigger_type, tradingsymbol, exchange, trigger_values, last_price, orders)</p>
    </div>
    

    
  
    <div class="desc"><p>Place GTT order</p>
<ul>
<li><code>trigger_type</code> The type of GTT order(single/two-leg).</li>
<li><code>tradingsymbol</code> Trading symbol of the instrument.</li>
<li><code>exchange</code> Name of the exchange.</li>
<li><code>trigger_values</code> Trigger values (json array).</li>
<li><code>last_price</code> Last price of the instrument at the time of order placement.</li>
<li><code>orders</code> JSON order array containing following fields<ul>
<li><code>transaction_type</code> BUY or SELL</li>
<li><code>quantity</code> Quantity to transact</li>
<li><code>price</code> The min or max price to execute the order at (for LIMIT orders)</li>
</ul>
</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.place_gtt', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.place_gtt" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">place_gtt</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">trigger_type</span><span class="p">,</span> <span class="n">tradingsymbol</span><span class="p">,</span> <span class="n">exchange</span><span class="p">,</span> <span class="n">trigger_values</span><span class="p">,</span> <span class="n">last_price</span><span class="p">,</span> <span class="n">orders</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Place GTT order</span>
<span class="sd">    - `trigger_type` The type of GTT order(single/two-leg).</span>
<span class="sd">    - `tradingsymbol` Trading symbol of the instrument.</span>
<span class="sd">    - `exchange` Name of the exchange.</span>
<span class="sd">    - `trigger_values` Trigger values (json array).</span>
<span class="sd">    - `last_price` Last price of the instrument at the time of order placement.</span>
<span class="sd">    - `orders` JSON order array containing following fields</span>
<span class="sd">        - `transaction_type` BUY or SELL</span>
<span class="sd">        - `quantity` Quantity to transact</span>
<span class="sd">        - `price` The min or max price to execute the order at (for LIMIT orders)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validations.</span>
    <span class="k">assert</span> <span class="n">trigger_type</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">GTT_TYPE_OCO</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GTT_TYPE_SINGLE</span><span class="p">]</span>
    <span class="n">condition</span><span class="p">,</span> <span class="n">gtt_orders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_gtt_payload</span><span class="p">(</span><span class="n">trigger_type</span><span class="p">,</span> <span class="n">tradingsymbol</span><span class="p">,</span> <span class="n">exchange</span><span class="p">,</span> <span class="n">trigger_values</span><span class="p">,</span> <span class="n">last_price</span><span class="p">,</span> <span class="n">orders</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;gtt.place&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;condition&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">condition</span><span class="p">),</span>
        <span class="s2">&quot;orders&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">gtt_orders</span><span class="p">),</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">trigger_type</span><span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.place_mf_order">
    <p>def <span class="ident">place_mf_order</span>(</p><p>self, tradingsymbol, transaction_type, quantity=None, amount=None, tag=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Place a mutual fund order.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.place_mf_order', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.place_mf_order" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">place_mf_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                   <span class="n">tradingsymbol</span><span class="p">,</span>
                   <span class="n">transaction_type</span><span class="p">,</span>
                   <span class="n">quantity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">amount</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Place a mutual fund order.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;mf.order.place&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;tradingsymbol&quot;</span><span class="p">:</span> <span class="n">tradingsymbol</span><span class="p">,</span>
        <span class="s2">&quot;transaction_type&quot;</span><span class="p">:</span> <span class="n">transaction_type</span><span class="p">,</span>
        <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="n">quantity</span><span class="p">,</span>
        <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
        <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="n">tag</span>
    <span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.place_mf_sip">
    <p>def <span class="ident">place_mf_sip</span>(</p><p>self, tradingsymbol, amount, instalments, frequency, initial_amount=None, instalment_day=None, tag=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Place a mutual fund SIP.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.place_mf_sip', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.place_mf_sip" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">place_mf_sip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">tradingsymbol</span><span class="p">,</span>
                 <span class="n">amount</span><span class="p">,</span>
                 <span class="n">instalments</span><span class="p">,</span>
                 <span class="n">frequency</span><span class="p">,</span>
                 <span class="n">initial_amount</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">instalment_day</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Place a mutual fund SIP.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;mf.sip.place&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;tradingsymbol&quot;</span><span class="p">:</span> <span class="n">tradingsymbol</span><span class="p">,</span>
        <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
        <span class="s2">&quot;initial_amount&quot;</span><span class="p">:</span> <span class="n">initial_amount</span><span class="p">,</span>
        <span class="s2">&quot;instalments&quot;</span><span class="p">:</span> <span class="n">instalments</span><span class="p">,</span>
        <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="n">frequency</span><span class="p">,</span>
        <span class="s2">&quot;instalment_day&quot;</span><span class="p">:</span> <span class="n">instalment_day</span><span class="p">,</span>
        <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="n">tag</span>
    <span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.place_order">
    <p>def <span class="ident">place_order</span>(</p><p>self, variety, exchange, tradingsymbol, transaction_type, quantity, product, order_type, price=None, validity=None, disclosed_quantity=None, trigger_price=None, squareoff=None, stoploss=None, trailing_stoploss=None, tag=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Place an order.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.place_order', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.place_order" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">place_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">variety</span><span class="p">,</span>
                <span class="n">exchange</span><span class="p">,</span>
                <span class="n">tradingsymbol</span><span class="p">,</span>
                <span class="n">transaction_type</span><span class="p">,</span>
                <span class="n">quantity</span><span class="p">,</span>
                <span class="n">product</span><span class="p">,</span>
                <span class="n">order_type</span><span class="p">,</span>
                <span class="n">price</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">validity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">disclosed_quantity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">trigger_price</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">squareoff</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">stoploss</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">trailing_stoploss</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Place an order.&quot;&quot;&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
    <span class="k">del</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;self&quot;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">del</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;order.place&quot;</span><span class="p">,</span>
                      <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;variety&quot;</span><span class="p">:</span> <span class="n">variety</span><span class="p">},</span>
                      <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)[</span><span class="s2">&quot;order_id&quot;</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.positions">
    <p>def <span class="ident">positions</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Retrieve the list of positions.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.positions', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.positions" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">positions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Retrieve the list of positions.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;portfolio.positions&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.profile">
    <p>def <span class="ident">profile</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Get user profile details.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.profile', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.profile" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get user profile details.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;user.profile&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.quote">
    <p>def <span class="ident">quote</span>(</p><p>self, *instruments)</p>
    </div>
    

    
  
    <div class="desc"><p>Retrieve quote for list of instruments.</p>
<ul>
<li><code>instruments</code> is a list of instruments, Instrument are in the format of <code>exchange:tradingsymbol</code>. For example NSE:INFY</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.quote', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.quote" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">quote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">instruments</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve quote for list of instruments.</span>
<span class="sd">    - `instruments` is a list of instruments, Instrument are in the format of `exchange:tradingsymbol`. For example NSE:INFY</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ins</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span>
    <span class="c1"># If first element is a list then accept it as instruments list for legacy reason</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">ins</span> <span class="o">=</span> <span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.quote&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="n">ins</span><span class="p">})</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">}</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.renew_access_token">
    <p>def <span class="ident">renew_access_token</span>(</p><p>self, refresh_token, api_secret)</p>
    </div>
    

    
  
    <div class="desc"><p>Renew expired <code>refresh_token</code> using valid <code>refresh_token</code>.</p>
<ul>
<li><code>refresh_token</code> is the token obtained from previous successful login flow.</li>
<li><code>api_secret</code> is the API api_secret issued with the API key.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.renew_access_token', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.renew_access_token" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">renew_access_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Renew expired `refresh_token` using valid `refresh_token`.</span>
<span class="sd">    - `refresh_token` is the token obtained from previous successful login flow.</span>
<span class="sd">    - `api_secret` is the API api_secret issued with the API key.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">refresh_token</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">api_secret</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
    <span class="n">checksum</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;api.token.renew&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;api_key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_key</span><span class="p">,</span>
        <span class="s2">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="n">refresh_token</span><span class="p">,</span>
        <span class="s2">&quot;checksum&quot;</span><span class="p">:</span> <span class="n">checksum</span>
    <span class="p">})</span>
    <span class="k">if</span> <span class="s2">&quot;access_token&quot;</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_access_token</span><span class="p">(</span><span class="n">resp</span><span class="p">[</span><span class="s2">&quot;access_token&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">resp</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.set_access_token">
    <p>def <span class="ident">set_access_token</span>(</p><p>self, access_token)</p>
    </div>
    

    
  
    <div class="desc"><p>Set the <code>access_token</code> received after a successful authentication.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.set_access_token', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.set_access_token" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_access_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">access_token</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set the `access_token` received after a successful authentication.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="n">access_token</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.set_session_expiry_hook">
    <p>def <span class="ident">set_session_expiry_hook</span>(</p><p>self, method)</p>
    </div>
    

    
  
    <div class="desc"><p>Set a callback hook for session (<code>TokenError</code> -- timeout, expiry etc.) errors.</p>
<p>An <code>access_token</code> (login session) can become invalid for a number of
reasons, but it doesn't make sense for the client to
try and catch it during every API call.</p>
<p>A callback method that handles session errors
can be set here and when the client encounters
a token error at any point, it'll be called.</p>
<p>This callback, for instance, can log the user out of the UI,
clear session cookies, or initiate a fresh login.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.set_session_expiry_hook', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.set_session_expiry_hook" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_session_expiry_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set a callback hook for session (`TokenError` -- timeout, expiry etc.) errors.</span>
<span class="sd">    An `access_token` (login session) can become invalid for a number of</span>
<span class="sd">    reasons, but it doesn&#39;t make sense for the client to</span>
<span class="sd">    try and catch it during every API call.</span>
<span class="sd">    A callback method that handles session errors</span>
<span class="sd">    can be set here and when the client encounters</span>
<span class="sd">    a token error at any point, it&#39;ll be called.</span>
<span class="sd">    This callback, for instance, can log the user out of the UI,</span>
<span class="sd">    clear session cookies, or initiate a fresh login.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid input type. Only functions are accepted.&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">session_expiry_hook</span> <span class="o">=</span> <span class="n">method</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.trades">
    <p>def <span class="ident">trades</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Retrieve the list of trades executed (all or ones under a particular order).</p>
<p>An order can be executed in tranches based on market conditions.
These trades are individually recorded under an order.</p>
<ul>
<li><code>order_id</code> is the ID of the order (optional) whose trades are to be retrieved.
If no <code>order_id</code> is specified, all trades for the day are returned.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.trades', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.trades" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">trades</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve the list of trades executed (all or ones under a particular order).</span>
<span class="sd">    An order can be executed in tranches based on market conditions.</span>
<span class="sd">    These trades are individually recorded under an order.</span>
<span class="sd">    - `order_id` is the ID of the order (optional) whose trades are to be retrieved.</span>
<span class="sd">    If no `order_id` is specified, all trades for the day are returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;trades&quot;</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteConnect.trigger_range">
    <p>def <span class="ident">trigger_range</span>(</p><p>self, transaction_type, *instruments)</p>
    </div>
    

    
  
    <div class="desc"><p>Retrieve the buy/sell trigger range for Cover Orders.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteConnect.trigger_range', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteConnect.trigger_range" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">trigger_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction_type</span><span class="p">,</span> <span class="o">*</span><span class="n">instruments</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Retrieve the buy/sell trigger range for Cover Orders.&quot;&quot;&quot;</span>
    <span class="n">ins</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span>
    <span class="c1"># If first element is a list then accept it as instruments list for legacy reason</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instruments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">ins</span> <span class="o">=</span> <span class="n">instruments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;market.trigger_range&quot;</span><span class="p">,</span>
                     <span class="n">url_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;transaction_type&quot;</span><span class="p">:</span> <span class="n">transaction_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()},</span>
                     <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="n">ins</span><span class="p">})</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="kiteconnect.KiteConnect.access_token" class="name">var <span class="ident">access_token</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.api_key" class="name">var <span class="ident">api_key</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.debug" class="name">var <span class="ident">debug</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.disable_ssl" class="name">var <span class="ident">disable_ssl</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.proxies" class="name">var <span class="ident">proxies</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.root" class="name">var <span class="ident">root</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.session_expiry_hook" class="name">var <span class="ident">session_expiry_hook</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteConnect.timeout" class="name">var <span class="ident">timeout</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="kiteconnect.KiteTicker" class="name">class <span class="ident">KiteTicker</span></p>
      
  
    <div class="desc"><p>The WebSocket client for connecting to Kite Connect's streaming quotes service.</p>
<h2>Getting started:</h2>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">kiteconnect</span> <span class="kn">import</span> <span class="n">KiteTicker</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="c1"># Initialise</span>
<span class="n">kws</span> <span class="o">=</span> <span class="n">KiteTicker</span><span class="p">(</span><span class="s2">&quot;your_api_key&quot;</span><span class="p">,</span> <span class="s2">&quot;your_access_token&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">on_ticks</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">ticks</span><span class="p">):</span>
    <span class="c1"># Callback to receive ticks.</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Ticks: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ticks</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">on_connect</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
    <span class="c1"># Callback on successful connect.</span>
    <span class="c1"># Subscribe to a list of instrument_tokens (RELIANCE and ACC here).</span>
    <span class="n">ws</span><span class="o">.</span><span class="n">subscribe</span><span class="p">([</span><span class="mi">738561</span><span class="p">,</span> <span class="mi">5633</span><span class="p">])</span>

    <span class="c1"># Set RELIANCE to tick in `full` mode.</span>
    <span class="n">ws</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">MODE_FULL</span><span class="p">,</span> <span class="p">[</span><span class="mi">738561</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">reason</span><span class="p">):</span>
    <span class="c1"># On connection close stop the event loop.</span>
    <span class="c1"># Reconnection will not happen after executing `ws.stop()`</span>
    <span class="n">ws</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

<span class="c1"># Assign the callbacks.</span>
<span class="n">kws</span><span class="o">.</span><span class="n">on_ticks</span> <span class="o">=</span> <span class="n">on_ticks</span>
<span class="n">kws</span><span class="o">.</span><span class="n">on_connect</span> <span class="o">=</span> <span class="n">on_connect</span>
<span class="n">kws</span><span class="o">.</span><span class="n">on_close</span> <span class="o">=</span> <span class="n">on_close</span>

<span class="c1"># Infinite loop on the main thread. Nothing after this will run.</span>
<span class="c1"># You have to use the pre-defined callbacks to manage subscriptions.</span>
<span class="n">kws</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>


<h2>Callbacks</h2>
<p>In below examples <code>ws</code> is the currently initialised WebSocket object.</p>
<ul>
<li><code>on_ticks(ws, ticks)</code> -  Triggered when ticks are recevied.<ul>
<li><code>ticks</code> - List of <code>tick</code> object. Check below for sample structure.</li>
</ul>
</li>
<li><code>on_close(ws, code, reason)</code> -  Triggered when connection is closed.<ul>
<li><code>code</code> - WebSocket standard close event code (https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent)</li>
<li><code>reason</code> - DOMString indicating the reason the server closed the connection</li>
</ul>
</li>
<li><code>on_error(ws, code, reason)</code> -  Triggered when connection is closed with an error.<ul>
<li><code>code</code> - WebSocket standard close event code (https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent)</li>
<li><code>reason</code> - DOMString indicating the reason the server closed the connection</li>
</ul>
</li>
<li><code>on_connect</code> -  Triggered when connection is established successfully.<ul>
<li><code>response</code> - Response received from server on successful connection.</li>
</ul>
</li>
<li><code>on_message(ws, payload, is_binary)</code> -  Triggered when message is received from the server.<ul>
<li><code>payload</code> - Raw response from the server (either text or binary).</li>
<li><code>is_binary</code> - Bool to check if response is binary type.</li>
</ul>
</li>
<li><code>on_reconnect(ws, attempts_count)</code> -  Triggered when auto reconnection is attempted.<ul>
<li><code>attempts_count</code> - Current reconnect attempt number.</li>
</ul>
</li>
<li><code>on_noreconnect(ws)</code> -  Triggered when number of auto reconnection attempts exceeds <code>reconnect_tries</code>.</li>
<li><code>on_order_update(ws, data)</code> -  Triggered when there is an order update for the connected user.</li>
</ul>
<h2>Tick structure (passed to the <code>on_ticks</code> callback)</h2>
<div class="codehilite"><pre><span></span>[{
    &#39;instrument_token&#39;: 53490439,
    &#39;mode&#39;: &#39;full&#39;,
    &#39;volume&#39;: 12510,
    &#39;last_price&#39;: 4084.0,
    &#39;average_price&#39;: 4086.55,
    &#39;last_quantity&#39;: 1,
    &#39;buy_quantity&#39;: 2356
    &#39;sell_quantity&#39;: 2440,
    &#39;change&#39;: 0.46740467404674046,
    &#39;last_trade_time&#39;: datetime.datetime(2018, 1, 15, 13, 16, 54),
    &#39;timestamp&#39;: datetime.datetime(2018, 1, 15, 13, 16, 56),
    &#39;oi&#39;: 21845,
    &#39;oi_day_low&#39;: 0,
    &#39;oi_day_high&#39;: 0,
    &#39;ohlc&#39;: {
        &#39;high&#39;: 4093.0,
        &#39;close&#39;: 4065.0,
        &#39;open&#39;: 4088.0,
        &#39;low&#39;: 4080.0
    },
    &#39;tradable&#39;: True,
    &#39;depth&#39;: {
        &#39;sell&#39;: [{
            &#39;price&#39;: 4085.0,
            &#39;orders&#39;: 1048576,
            &#39;quantity&#39;: 43
        }, {
            &#39;price&#39;: 4086.0,
            &#39;orders&#39;: 2752512,
            &#39;quantity&#39;: 134
        }, {
            &#39;price&#39;: 4087.0,
            &#39;orders&#39;: 1703936,
            &#39;quantity&#39;: 133
        }, {
            &#39;price&#39;: 4088.0,
            &#39;orders&#39;: 1376256,
            &#39;quantity&#39;: 70
        }, {
            &#39;price&#39;: 4089.0,
            &#39;orders&#39;: 1048576,
            &#39;quantity&#39;: 46
        }],
        &#39;buy&#39;: [{
            &#39;price&#39;: 4084.0,
            &#39;orders&#39;: 589824,
            &#39;quantity&#39;: 53
        }, {
            &#39;price&#39;: 4083.0,
            &#39;orders&#39;: 1245184,
            &#39;quantity&#39;: 145
        }, {
            &#39;price&#39;: 4082.0,
            &#39;orders&#39;: 1114112,
            &#39;quantity&#39;: 63
        }, {
            &#39;price&#39;: 4081.0,
            &#39;orders&#39;: 1835008,
            &#39;quantity&#39;: 69
        }, {
            &#39;price&#39;: 4080.0,
            &#39;orders&#39;: 2752512,
            &#39;quantity&#39;: 89
        }]
    }
},
...,
...]
</pre></div>


<h2>Auto reconnection</h2>
<p>Auto reconnection is enabled by default and it can be disabled by passing <code>reconnect</code> param while initialising <code>KiteTicker</code>.
On a side note, reconnection mechanism cannot happen if event loop is terminated using <code>stop</code> method inside <code>on_close</code> callback.</p>
<p>Auto reonnection mechanism is based on <a href="https://en.wikipedia.org/wiki/Exponential_backoff">Exponential backoff</a> algorithm in which
next retry interval will be increased exponentially. <code>reconnect_max_delay</code> and <code>reconnect_max_tries</code> params can be used to tewak
the alogrithm where <code>reconnect_max_delay</code> is the maximum delay after which subsequent reconnection interval will become constant and
<code>reconnect_max_tries</code> is maximum number of retries before its quiting reconnection.</p>
<p>For example if <code>reconnect_max_delay</code> is 60 seconds and <code>reconnect_max_tries</code> is 50 then the first reconnection interval starts from
minimum interval which is 2 seconds and keep increasing up to 60 seconds after which it becomes constant and when reconnection attempt
is reached upto 50 then it stops reconnecting.</p>
<p>method <code>stop_retry</code> can be used to stop ongoing reconnect attempts and <code>on_reconnect</code> callback will be called with current reconnect
attempt and <code>on_noreconnect</code> is called when reconnection attempts reaches max retries.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteTicker', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteTicker" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">KiteTicker</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The WebSocket client for connecting to Kite Connect&#39;s streaming quotes service.</span>

<span class="sd">    Getting started:</span>
<span class="sd">    ---------------</span>
<span class="sd">        #!python</span>
<span class="sd">        import logging</span>
<span class="sd">        from kiteconnect import KiteTicker</span>

<span class="sd">        logging.basicConfig(level=logging.DEBUG)</span>

<span class="sd">        # Initialise</span>
<span class="sd">        kws = KiteTicker(&quot;your_api_key&quot;, &quot;your_access_token&quot;)</span>

<span class="sd">        def on_ticks(ws, ticks):</span>
<span class="sd">            # Callback to receive ticks.</span>
<span class="sd">            logging.debug(&quot;Ticks: {}&quot;.format(ticks))</span>

<span class="sd">        def on_connect(ws, response):</span>
<span class="sd">            # Callback on successful connect.</span>
<span class="sd">            # Subscribe to a list of instrument_tokens (RELIANCE and ACC here).</span>
<span class="sd">            ws.subscribe([738561, 5633])</span>

<span class="sd">            # Set RELIANCE to tick in `full` mode.</span>
<span class="sd">            ws.set_mode(ws.MODE_FULL, [738561])</span>

<span class="sd">        def on_close(ws, code, reason):</span>
<span class="sd">            # On connection close stop the event loop.</span>
<span class="sd">            # Reconnection will not happen after executing `ws.stop()`</span>
<span class="sd">            ws.stop()</span>

<span class="sd">        # Assign the callbacks.</span>
<span class="sd">        kws.on_ticks = on_ticks</span>
<span class="sd">        kws.on_connect = on_connect</span>
<span class="sd">        kws.on_close = on_close</span>

<span class="sd">        # Infinite loop on the main thread. Nothing after this will run.</span>
<span class="sd">        # You have to use the pre-defined callbacks to manage subscriptions.</span>
<span class="sd">        kws.connect()</span>

<span class="sd">    Callbacks</span>
<span class="sd">    ---------</span>
<span class="sd">    In below examples `ws` is the currently initialised WebSocket object.</span>

<span class="sd">    - `on_ticks(ws, ticks)` -  Triggered when ticks are recevied.</span>
<span class="sd">        - `ticks` - List of `tick` object. Check below for sample structure.</span>
<span class="sd">    - `on_close(ws, code, reason)` -  Triggered when connection is closed.</span>
<span class="sd">        - `code` - WebSocket standard close event code (https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent)</span>
<span class="sd">        - `reason` - DOMString indicating the reason the server closed the connection</span>
<span class="sd">    - `on_error(ws, code, reason)` -  Triggered when connection is closed with an error.</span>
<span class="sd">        - `code` - WebSocket standard close event code (https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent)</span>
<span class="sd">        - `reason` - DOMString indicating the reason the server closed the connection</span>
<span class="sd">    - `on_connect` -  Triggered when connection is established successfully.</span>
<span class="sd">        - `response` - Response received from server on successful connection.</span>
<span class="sd">    - `on_message(ws, payload, is_binary)` -  Triggered when message is received from the server.</span>
<span class="sd">        - `payload` - Raw response from the server (either text or binary).</span>
<span class="sd">        - `is_binary` - Bool to check if response is binary type.</span>
<span class="sd">    - `on_reconnect(ws, attempts_count)` -  Triggered when auto reconnection is attempted.</span>
<span class="sd">        - `attempts_count` - Current reconnect attempt number.</span>
<span class="sd">    - `on_noreconnect(ws)` -  Triggered when number of auto reconnection attempts exceeds `reconnect_tries`.</span>
<span class="sd">    - `on_order_update(ws, data)` -  Triggered when there is an order update for the connected user.</span>


<span class="sd">    Tick structure (passed to the `on_ticks` callback)</span>
<span class="sd">    ---------------------------</span>
<span class="sd">        [{</span>
<span class="sd">            &#39;instrument_token&#39;: 53490439,</span>
<span class="sd">            &#39;mode&#39;: &#39;full&#39;,</span>
<span class="sd">            &#39;volume&#39;: 12510,</span>
<span class="sd">            &#39;last_price&#39;: 4084.0,</span>
<span class="sd">            &#39;average_price&#39;: 4086.55,</span>
<span class="sd">            &#39;last_quantity&#39;: 1,</span>
<span class="sd">            &#39;buy_quantity&#39;: 2356</span>
<span class="sd">            &#39;sell_quantity&#39;: 2440,</span>
<span class="sd">            &#39;change&#39;: 0.46740467404674046,</span>
<span class="sd">            &#39;last_trade_time&#39;: datetime.datetime(2018, 1, 15, 13, 16, 54),</span>
<span class="sd">            &#39;timestamp&#39;: datetime.datetime(2018, 1, 15, 13, 16, 56),</span>
<span class="sd">            &#39;oi&#39;: 21845,</span>
<span class="sd">            &#39;oi_day_low&#39;: 0,</span>
<span class="sd">            &#39;oi_day_high&#39;: 0,</span>
<span class="sd">            &#39;ohlc&#39;: {</span>
<span class="sd">                &#39;high&#39;: 4093.0,</span>
<span class="sd">                &#39;close&#39;: 4065.0,</span>
<span class="sd">                &#39;open&#39;: 4088.0,</span>
<span class="sd">                &#39;low&#39;: 4080.0</span>
<span class="sd">            },</span>
<span class="sd">            &#39;tradable&#39;: True,</span>
<span class="sd">            &#39;depth&#39;: {</span>
<span class="sd">                &#39;sell&#39;: [{</span>
<span class="sd">                    &#39;price&#39;: 4085.0,</span>
<span class="sd">                    &#39;orders&#39;: 1048576,</span>
<span class="sd">                    &#39;quantity&#39;: 43</span>
<span class="sd">                }, {</span>
<span class="sd">                    &#39;price&#39;: 4086.0,</span>
<span class="sd">                    &#39;orders&#39;: 2752512,</span>
<span class="sd">                    &#39;quantity&#39;: 134</span>
<span class="sd">                }, {</span>
<span class="sd">                    &#39;price&#39;: 4087.0,</span>
<span class="sd">                    &#39;orders&#39;: 1703936,</span>
<span class="sd">                    &#39;quantity&#39;: 133</span>
<span class="sd">                }, {</span>
<span class="sd">                    &#39;price&#39;: 4088.0,</span>
<span class="sd">                    &#39;orders&#39;: 1376256,</span>
<span class="sd">                    &#39;quantity&#39;: 70</span>
<span class="sd">                }, {</span>
<span class="sd">                    &#39;price&#39;: 4089.0,</span>
<span class="sd">                    &#39;orders&#39;: 1048576,</span>
<span class="sd">                    &#39;quantity&#39;: 46</span>
<span class="sd">                }],</span>
<span class="sd">                &#39;buy&#39;: [{</span>
<span class="sd">                    &#39;price&#39;: 4084.0,</span>
<span class="sd">                    &#39;orders&#39;: 589824,</span>
<span class="sd">                    &#39;quantity&#39;: 53</span>
<span class="sd">                }, {</span>
<span class="sd">                    &#39;price&#39;: 4083.0,</span>
<span class="sd">                    &#39;orders&#39;: 1245184,</span>
<span class="sd">                    &#39;quantity&#39;: 145</span>
<span class="sd">                }, {</span>
<span class="sd">                    &#39;price&#39;: 4082.0,</span>
<span class="sd">                    &#39;orders&#39;: 1114112,</span>
<span class="sd">                    &#39;quantity&#39;: 63</span>
<span class="sd">                }, {</span>
<span class="sd">                    &#39;price&#39;: 4081.0,</span>
<span class="sd">                    &#39;orders&#39;: 1835008,</span>
<span class="sd">                    &#39;quantity&#39;: 69</span>
<span class="sd">                }, {</span>
<span class="sd">                    &#39;price&#39;: 4080.0,</span>
<span class="sd">                    &#39;orders&#39;: 2752512,</span>
<span class="sd">                    &#39;quantity&#39;: 89</span>
<span class="sd">                }]</span>
<span class="sd">            }</span>
<span class="sd">        },</span>
<span class="sd">        ...,</span>
<span class="sd">        ...]</span>

<span class="sd">    Auto reconnection</span>
<span class="sd">    -----------------</span>

<span class="sd">    Auto reconnection is enabled by default and it can be disabled by passing `reconnect` param while initialising `KiteTicker`.</span>
<span class="sd">    On a side note, reconnection mechanism cannot happen if event loop is terminated using `stop` method inside `on_close` callback.</span>

<span class="sd">    Auto reonnection mechanism is based on [Exponential backoff](https://en.wikipedia.org/wiki/Exponential_backoff) algorithm in which</span>
<span class="sd">    next retry interval will be increased exponentially. `reconnect_max_delay` and `reconnect_max_tries` params can be used to tewak</span>
<span class="sd">    the alogrithm where `reconnect_max_delay` is the maximum delay after which subsequent reconnection interval will become constant and</span>
<span class="sd">    `reconnect_max_tries` is maximum number of retries before its quiting reconnection.</span>

<span class="sd">    For example if `reconnect_max_delay` is 60 seconds and `reconnect_max_tries` is 50 then the first reconnection interval starts from</span>
<span class="sd">    minimum interval which is 2 seconds and keep increasing up to 60 seconds after which it becomes constant and when reconnection attempt</span>
<span class="sd">    is reached upto 50 then it stops reconnecting.</span>

<span class="sd">    method `stop_retry` can be used to stop ongoing reconnect attempts and `on_reconnect` callback will be called with current reconnect</span>
<span class="sd">    attempt and `on_noreconnect` is called when reconnection attempts reaches max retries.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">EXCHANGE_MAP</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;nse&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;nfo&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;cds&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;bse&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;bfo&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s2">&quot;bsecds&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s2">&quot;mcx&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
        <span class="s2">&quot;mcxsx&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="s2">&quot;indices&quot;</span><span class="p">:</span> <span class="mi">9</span>
    <span class="p">}</span>

    <span class="c1"># Default connection timeout</span>
    <span class="n">CONNECT_TIMEOUT</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="c1"># Default Reconnect max delay.</span>
    <span class="n">RECONNECT_MAX_DELAY</span> <span class="o">=</span> <span class="mi">60</span>
    <span class="c1"># Default reconnect attempts</span>
    <span class="n">RECONNECT_MAX_TRIES</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="c1"># Default root API endpoint. It&#39;s possible to</span>
    <span class="c1"># override this by passing the `root` parameter during initialisation.</span>
    <span class="n">ROOT_URI</span> <span class="o">=</span> <span class="s2">&quot;wss://ws.kite.trade&quot;</span>

    <span class="c1"># Available streaming modes.</span>
    <span class="n">MODE_FULL</span> <span class="o">=</span> <span class="s2">&quot;full&quot;</span>
    <span class="n">MODE_QUOTE</span> <span class="o">=</span> <span class="s2">&quot;quote&quot;</span>
    <span class="n">MODE_LTP</span> <span class="o">=</span> <span class="s2">&quot;ltp&quot;</span>

    <span class="c1"># Flag to set if its first connect</span>
    <span class="n">_is_first_connect</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Available actions.</span>
    <span class="n">_message_code</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">_message_subscribe</span> <span class="o">=</span> <span class="s2">&quot;subscribe&quot;</span>
    <span class="n">_message_unsubscribe</span> <span class="o">=</span> <span class="s2">&quot;unsubscribe&quot;</span>
    <span class="n">_message_setmode</span> <span class="o">=</span> <span class="s2">&quot;mode&quot;</span>

    <span class="c1"># Minimum delay which should be set between retries. User can&#39;t set less than this</span>
    <span class="n">_minimum_reconnect_max_delay</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="c1"># Maximum number or retries user can set</span>
    <span class="n">_maximum_reconnect_max_tries</span> <span class="o">=</span> <span class="mi">300</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">access_token</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">reconnect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reconnect_max_tries</span><span class="o">=</span><span class="n">RECONNECT_MAX_TRIES</span><span class="p">,</span> <span class="n">reconnect_max_delay</span><span class="o">=</span><span class="n">RECONNECT_MAX_DELAY</span><span class="p">,</span>
                 <span class="n">connect_timeout</span><span class="o">=</span><span class="n">CONNECT_TIMEOUT</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise websocket client instance.</span>

<span class="sd">        - `api_key` is the API key issued to you</span>
<span class="sd">        - `access_token` is the token obtained after the login flow in</span>
<span class="sd">            exchange for the `request_token`. Pre-login, this will default to None,</span>
<span class="sd">            but once you have obtained it, you should</span>
<span class="sd">            persist it in a database or session to pass</span>
<span class="sd">            to the Kite Connect class initialisation for subsequent requests.</span>
<span class="sd">        - `root` is the websocket API end point root. Unless you explicitly</span>
<span class="sd">            want to send API requests to a non-default endpoint, this</span>
<span class="sd">            can be ignored.</span>
<span class="sd">        - `reconnect` is a boolean to enable WebSocket autreconnect in case of network failure/disconnection.</span>
<span class="sd">        - `reconnect_max_delay` in seconds is the maximum delay after which subsequent reconnection interval will become constant. Defaults to 60s and minimum acceptable value is 5s.</span>
<span class="sd">        - `reconnect_max_tries` is maximum number reconnection attempts. Defaults to 50 attempts and maximum up to 300 attempts.</span>
<span class="sd">        - `connect_timeout` in seconds is the maximum interval after which connection is considered as timeout. Defaults to 30s.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ROOT_URI</span>

        <span class="c1"># Set max reconnect tries</span>
        <span class="k">if</span> <span class="n">reconnect_max_tries</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_reconnect_max_tries</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;`reconnect_max_tries` can not be more than </span><span class="si">{val}</span><span class="s2">. Setting to highest possible value - </span><span class="si">{val}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_maximum_reconnect_max_tries</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reconnect_max_tries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_reconnect_max_tries</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reconnect_max_tries</span> <span class="o">=</span> <span class="n">reconnect_max_tries</span>

        <span class="c1"># Set max reconnect delay</span>
        <span class="k">if</span> <span class="n">reconnect_max_delay</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minimum_reconnect_max_delay</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;`reconnect_max_delay` can not be less than </span><span class="si">{val}</span><span class="s2">. Setting to lowest possible value - </span><span class="si">{val}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_minimum_reconnect_max_delay</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reconnect_max_delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minimum_reconnect_max_delay</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reconnect_max_delay</span> <span class="o">=</span> <span class="n">reconnect_max_delay</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connect_timeout</span> <span class="o">=</span> <span class="n">connect_timeout</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">socket_url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{root}</span><span class="s2">?api_key=</span><span class="si">{api_key}</span><span class="s2">&quot;</span>\
            <span class="s2">&quot;&amp;access_token=</span><span class="si">{access_token}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span>
                <span class="n">api_key</span><span class="o">=</span><span class="n">api_key</span><span class="p">,</span>
                <span class="n">access_token</span><span class="o">=</span><span class="n">access_token</span>
            <span class="p">)</span>

        <span class="c1"># Debug enables logs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>

        <span class="c1"># Placeholders for callbacks.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_ticks</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_close</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_error</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_connect</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_message</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_reconnect</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_noreconnect</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Text message updates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_order_update</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># List of current subscribed tokens</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subscribed_tokens</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">_create_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a WebSocket client connection.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span> <span class="o">=</span> <span class="n">KiteTickerClientFactory</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Alias for current websocket connection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">ws</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span>

        <span class="c1"># Register private callbacks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_open</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">on_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_error</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">on_close</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_close</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">on_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">on_connect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_connect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">on_reconnect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_reconnect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">on_noreconnect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_noreconnect</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">maxDelay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reconnect_max_delay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">maxRetries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reconnect_max_tries</span>

    <span class="k">def</span> <span class="nf">_user_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">__title__</span> <span class="o">+</span> <span class="s2">&quot;-python/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="o">+</span> <span class="n">__version__</span>

    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threaded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">disable_ssl_verification</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">proxy</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Establish a websocket connection.</span>

<span class="sd">        - `threaded` is a boolean indicating if the websocket client has to be run in threaded mode or not</span>
<span class="sd">        - `disable_ssl_verification` disables building ssl context</span>
<span class="sd">        - `proxy` is a dictionary with keys `host` and `port` which denotes the proxy settings</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Custom headers</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;X-Kite-Version&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>  <span class="c1"># For version 3</span>
        <span class="p">}</span>

        <span class="c1"># Init WebSocket client factory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_connection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">socket_url</span><span class="p">,</span>
                                <span class="n">useragent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_user_agent</span><span class="p">(),</span>
                                <span class="n">proxy</span><span class="o">=</span><span class="n">proxy</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

        <span class="c1"># Set SSL context</span>
        <span class="n">context_factory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">isSecure</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">disable_ssl_verification</span><span class="p">:</span>
            <span class="n">context_factory</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">ClientContextFactory</span><span class="p">()</span>

        <span class="c1"># Establish WebSocket connection to a server</span>
        <span class="n">connectWS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="p">,</span> <span class="n">contextFactory</span><span class="o">=</span><span class="n">context_factory</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connect_timeout</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="n">twisted_log</span><span class="o">.</span><span class="n">startLogging</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>

        <span class="c1"># Run in seperate thread of blocking</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Run when reactor is not running</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">reactor</span><span class="o">.</span><span class="n">running</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">threaded</span><span class="p">:</span>
                <span class="c1"># Signals are not allowed in non main thread by twisted so suppress it.</span>
                <span class="n">opts</span><span class="p">[</span><span class="s2">&quot;installSignalHandlers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">websocket_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">reactor</span><span class="o">.</span><span class="n">run</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">opts</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">websocket_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">websocket_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">reactor</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="o">**</span><span class="n">opts</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if WebSocket connection is established.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">STATE_OPEN</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close the WebSocket connection.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">sendClose</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">reason</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close the WebSocket connection.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_retry</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">reason</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop the event loop. Should be used if main thread has to be closed in `on_close` method.</span>
<span class="sd">        Reconnection mechanism cannot happen past this method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reactor</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">stop_retry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop auto retry when it is in progress.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">stopTrying</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">subscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instrument_tokens</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Subscribe to a list of instrument_tokens.</span>

<span class="sd">        - `instrument_tokens` is list of instrument instrument_tokens to subscribe</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;called&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_subscribe</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span>
                <span class="n">six</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_subscribe</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="n">instrument_tokens</span><span class="p">}))</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">instrument_tokens</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">subscribed_tokens</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MODE_QUOTE</span>

            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Error while subscribe: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instrument_tokens</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unsubscribe the given list of instrument_tokens.</span>

<span class="sd">        - `instrument_tokens` is list of instrument_tokens to unsubscribe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span>
                <span class="n">six</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_unsubscribe</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="n">instrument_tokens</span><span class="p">}))</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">instrument_tokens</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">del</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subscribed_tokens</span><span class="p">[</span><span class="n">token</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Error while unsubscribe: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">set_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">instrument_tokens</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set streaming mode for the given list of tokens.</span>

<span class="sd">        - `mode` is the mode to set. It can be one of the following class constants:</span>
<span class="sd">            MODE_LTP, MODE_QUOTE, or MODE_FULL.</span>
<span class="sd">        - `instrument_tokens` is list of instrument tokens on which the mode should be applied</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_setmode</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">instrument_tokens</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span>
                <span class="n">six</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_setmode</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">mode</span><span class="p">,</span> <span class="n">instrument_tokens</span><span class="p">]}))</span>
            <span class="p">)</span>

            <span class="c1"># Update modes</span>
            <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">instrument_tokens</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">subscribed_tokens</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode</span>

            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Error while setting mode: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">resubscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resubscribe to all current subscribed tokens.&quot;&quot;&quot;</span>
        <span class="n">modes</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subscribed_tokens</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subscribed_tokens</span><span class="p">[</span><span class="n">token</span><span class="p">]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">modes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                <span class="n">modes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">modes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Resubscribe and set mode: </span><span class="si">{}</span><span class="s2"> - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_on_connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="n">ws</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_connect</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">reason</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call `on_close` callback when connection is closed.&quot;&quot;&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Connection closed: </span><span class="si">{}</span><span class="s2"> - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">reason</span><span class="p">)))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_close</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">reason</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">reason</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call `on_error` callback when connection throws an error.&quot;&quot;&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Connection error: </span><span class="si">{}</span><span class="s2"> - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">reason</span><span class="p">)))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_error</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">reason</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span> <span class="n">is_binary</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call `on_message` callback when text message is received.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_message</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span> <span class="n">is_binary</span><span class="p">)</span>

        <span class="c1"># If the message is binary, parse it and send it to the callback.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ticks</span> <span class="ow">and</span> <span class="n">is_binary</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_binary</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>

        <span class="c1"># Parse text messages</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_binary</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parse_text_message</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ws</span><span class="p">):</span>
        <span class="c1"># Resubscribe if its reconnect</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_first_connect</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resubscribe</span><span class="p">()</span>

        <span class="c1"># Set first connect to false once its connected first time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_first_connect</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_open</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_open</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_reconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attempts_count</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_reconnect</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_reconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attempts_count</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_noreconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_noreconnect</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_noreconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_text_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse text message.&quot;&quot;&quot;</span>
        <span class="c1"># Decode unicode data</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">six</span><span class="o">.</span><span class="n">PY2</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bytes</span><span class="p">:</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Order update callback</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_order_update</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;order&quot;</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_order_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>

        <span class="c1"># Custom error with websocket error code 0</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_parse_binary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">bin</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse binary data to a (list of) ticks structure.&quot;&quot;&quot;</span>
        <span class="n">packets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_split_packets</span><span class="p">(</span><span class="nb">bin</span><span class="p">)</span>  <span class="c1"># split data to individual ticks packet</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">packet</span> <span class="ow">in</span> <span class="n">packets</span><span class="p">:</span>
            <span class="n">instrument_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">segment</span> <span class="o">=</span> <span class="n">instrument_token</span> <span class="o">&amp;</span> <span class="mh">0xff</span>  <span class="c1"># Retrive segment constant from instrument_token</span>

            <span class="n">divisor</span> <span class="o">=</span> <span class="mf">10000000.0</span> <span class="k">if</span> <span class="n">segment</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">EXCHANGE_MAP</span><span class="p">[</span><span class="s2">&quot;cds&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="mf">100.0</span>

            <span class="c1"># All indices are not tradable</span>
            <span class="n">tradable</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">segment</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">EXCHANGE_MAP</span><span class="p">[</span><span class="s2">&quot;indices&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">True</span>

            <span class="c1"># LTP packets</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s2">&quot;tradable&quot;</span><span class="p">:</span> <span class="n">tradable</span><span class="p">,</span>
                    <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">MODE_LTP</span><span class="p">,</span>
                    <span class="s2">&quot;instrument_token&quot;</span><span class="p">:</span> <span class="n">instrument_token</span><span class="p">,</span>
                    <span class="s2">&quot;last_price&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="o">/</span> <span class="n">divisor</span>
                <span class="p">})</span>
            <span class="c1"># Indices quote and full mode</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">28</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MODE_QUOTE</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">28</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">MODE_FULL</span>

                <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;tradable&quot;</span><span class="p">:</span> <span class="n">tradable</span><span class="p">,</span>
                    <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">mode</span><span class="p">,</span>
                    <span class="s2">&quot;instrument_token&quot;</span><span class="p">:</span> <span class="n">instrument_token</span><span class="p">,</span>
                    <span class="s2">&quot;last_price&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="o">/</span> <span class="n">divisor</span><span class="p">,</span>
                    <span class="s2">&quot;ohlc&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="o">/</span> <span class="n">divisor</span><span class="p">,</span>
                        <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="o">/</span> <span class="n">divisor</span><span class="p">,</span>
                        <span class="s2">&quot;open&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">/</span> <span class="n">divisor</span><span class="p">,</span>
                        <span class="s2">&quot;close&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span> <span class="o">/</span> <span class="n">divisor</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="c1"># Compute the change price using close price and last price</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;change&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;ohlc&quot;</span><span class="p">][</span><span class="s2">&quot;close&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;change&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;last_price&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;ohlc&quot;</span><span class="p">][</span><span class="s2">&quot;close&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;ohlc&quot;</span><span class="p">][</span><span class="s2">&quot;close&quot;</span><span class="p">]</span>

                <span class="c1"># Full mode with timestamp</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="n">timestamp</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timestamp</span>

                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="c1"># Quote and full mode</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">44</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">184</span><span class="p">:</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MODE_QUOTE</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">44</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">MODE_FULL</span>

                <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;tradable&quot;</span><span class="p">:</span> <span class="n">tradable</span><span class="p">,</span>
                    <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">mode</span><span class="p">,</span>
                    <span class="s2">&quot;instrument_token&quot;</span><span class="p">:</span> <span class="n">instrument_token</span><span class="p">,</span>
                    <span class="s2">&quot;last_price&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="o">/</span> <span class="n">divisor</span><span class="p">,</span>
                    <span class="s2">&quot;last_quantity&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
                    <span class="s2">&quot;average_price&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="o">/</span> <span class="n">divisor</span><span class="p">,</span>
                    <span class="s2">&quot;volume&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
                    <span class="s2">&quot;buy_quantity&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span>
                    <span class="s2">&quot;sell_quantity&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>
                    <span class="s2">&quot;ohlc&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;open&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span> <span class="o">/</span> <span class="n">divisor</span><span class="p">,</span>
                        <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">36</span><span class="p">)</span> <span class="o">/</span> <span class="n">divisor</span><span class="p">,</span>
                        <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span> <span class="o">/</span> <span class="n">divisor</span><span class="p">,</span>
                        <span class="s2">&quot;close&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span> <span class="o">/</span> <span class="n">divisor</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="c1"># Compute the change price using close price and last price</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;change&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;ohlc&quot;</span><span class="p">][</span><span class="s2">&quot;close&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;change&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;last_price&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;ohlc&quot;</span><span class="p">][</span><span class="s2">&quot;close&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;ohlc&quot;</span><span class="p">][</span><span class="s2">&quot;close&quot;</span><span class="p">]</span>

                <span class="c1"># Parse full mode</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">184</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">last_trade_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">48</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="n">last_trade_time</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="n">timestamp</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;last_trade_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_trade_time</span>
                    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;oi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">52</span><span class="p">)</span>
                    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;oi_day_high&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">56</span><span class="p">)</span>
                    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;oi_day_low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
                    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timestamp</span>

                    <span class="c1"># Market depth entries.</span>
                    <span class="n">depth</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;buy&quot;</span><span class="p">:</span> <span class="p">[],</span>
                        <span class="s2">&quot;sell&quot;</span><span class="p">:</span> <span class="p">[]</span>
                    <span class="p">}</span>

                    <span class="c1"># Compile the market depth lists.</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">packet</span><span class="p">),</span> <span class="mi">12</span><span class="p">)):</span>
                        <span class="n">depth</span><span class="p">[</span><span class="s2">&quot;sell&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">5</span> <span class="k">else</span> <span class="s2">&quot;buy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                            <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">4</span><span class="p">),</span>
                            <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">/</span> <span class="n">divisor</span><span class="p">,</span>
                            <span class="s2">&quot;orders&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">byte_format</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
                        <span class="p">})</span>

                    <span class="n">d</span><span class="p">[</span><span class="s2">&quot;depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">depth</span>

                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">_unpack_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">bin</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">byte_format</span><span class="o">=</span><span class="s2">&quot;I&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Unpack binary data as unsgined interger.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span> <span class="o">+</span> <span class="n">byte_format</span><span class="p">,</span> <span class="nb">bin</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_split_packets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">bin</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Split the data to individual packets of ticks.&quot;&quot;&quot;</span>
        <span class="c1"># Ignore heartbeat data.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">bin</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">number_of_packets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="nb">bin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">byte_format</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
        <span class="n">packets</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_packets</span><span class="p">):</span>
            <span class="n">packet_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_int</span><span class="p">(</span><span class="nb">bin</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">byte_format</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
            <span class="n">packets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">bin</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">packet_length</span><span class="p">])</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">packet_length</span>

        <span class="k">return</span> <span class="n">packets</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#kiteconnect.KiteTicker">KiteTicker</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="kiteconnect.KiteTicker.CONNECT_TIMEOUT" class="name">var <span class="ident">CONNECT_TIMEOUT</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.EXCHANGE_MAP" class="name">var <span class="ident">EXCHANGE_MAP</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.MODE_FULL" class="name">var <span class="ident">MODE_FULL</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.MODE_LTP" class="name">var <span class="ident">MODE_LTP</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.MODE_QUOTE" class="name">var <span class="ident">MODE_QUOTE</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.RECONNECT_MAX_DELAY" class="name">var <span class="ident">RECONNECT_MAX_DELAY</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.RECONNECT_MAX_TRIES" class="name">var <span class="ident">RECONNECT_MAX_TRIES</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.ROOT_URI" class="name">var <span class="ident">ROOT_URI</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteTicker.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, api_key, access_token, debug=False, root=None, reconnect=True, reconnect_max_tries=50, reconnect_max_delay=60, connect_timeout=30)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialise websocket client instance.</p>
<ul>
<li><code>api_key</code> is the API key issued to you</li>
<li><code>access_token</code> is the token obtained after the login flow in
    exchange for the <code>request_token</code>. Pre-login, this will default to None,
    but once you have obtained it, you should
    persist it in a database or session to pass
    to the Kite Connect class initialisation for subsequent requests.</li>
<li><code>root</code> is the websocket API end point root. Unless you explicitly
    want to send API requests to a non-default endpoint, this
    can be ignored.</li>
<li><code>reconnect</code> is a boolean to enable WebSocket autreconnect in case of network failure/disconnection.</li>
<li><code>reconnect_max_delay</code> in seconds is the maximum delay after which subsequent reconnection interval will become constant. Defaults to 60s and minimum acceptable value is 5s.</li>
<li><code>reconnect_max_tries</code> is maximum number reconnection attempts. Defaults to 50 attempts and maximum up to 300 attempts.</li>
<li><code>connect_timeout</code> in seconds is the maximum interval after which connection is considered as timeout. Defaults to 30s.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteTicker.__init__', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteTicker.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">access_token</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">reconnect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reconnect_max_tries</span><span class="o">=</span><span class="n">RECONNECT_MAX_TRIES</span><span class="p">,</span> <span class="n">reconnect_max_delay</span><span class="o">=</span><span class="n">RECONNECT_MAX_DELAY</span><span class="p">,</span>
             <span class="n">connect_timeout</span><span class="o">=</span><span class="n">CONNECT_TIMEOUT</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialise websocket client instance.</span>
<span class="sd">    - `api_key` is the API key issued to you</span>
<span class="sd">    - `access_token` is the token obtained after the login flow in</span>
<span class="sd">        exchange for the `request_token`. Pre-login, this will default to None,</span>
<span class="sd">        but once you have obtained it, you should</span>
<span class="sd">        persist it in a database or session to pass</span>
<span class="sd">        to the Kite Connect class initialisation for subsequent requests.</span>
<span class="sd">    - `root` is the websocket API end point root. Unless you explicitly</span>
<span class="sd">        want to send API requests to a non-default endpoint, this</span>
<span class="sd">        can be ignored.</span>
<span class="sd">    - `reconnect` is a boolean to enable WebSocket autreconnect in case of network failure/disconnection.</span>
<span class="sd">    - `reconnect_max_delay` in seconds is the maximum delay after which subsequent reconnection interval will become constant. Defaults to 60s and minimum acceptable value is 5s.</span>
<span class="sd">    - `reconnect_max_tries` is maximum number reconnection attempts. Defaults to 50 attempts and maximum up to 300 attempts.</span>
<span class="sd">    - `connect_timeout` in seconds is the maximum interval after which connection is considered as timeout. Defaults to 30s.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ROOT_URI</span>
    <span class="c1"># Set max reconnect tries</span>
    <span class="k">if</span> <span class="n">reconnect_max_tries</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_reconnect_max_tries</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;`reconnect_max_tries` can not be more than </span><span class="si">{val}</span><span class="s2">. Setting to highest possible value - </span><span class="si">{val}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_maximum_reconnect_max_tries</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reconnect_max_tries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_reconnect_max_tries</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reconnect_max_tries</span> <span class="o">=</span> <span class="n">reconnect_max_tries</span>
    <span class="c1"># Set max reconnect delay</span>
    <span class="k">if</span> <span class="n">reconnect_max_delay</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minimum_reconnect_max_delay</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;`reconnect_max_delay` can not be less than </span><span class="si">{val}</span><span class="s2">. Setting to lowest possible value - </span><span class="si">{val}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_minimum_reconnect_max_delay</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reconnect_max_delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minimum_reconnect_max_delay</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reconnect_max_delay</span> <span class="o">=</span> <span class="n">reconnect_max_delay</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">connect_timeout</span> <span class="o">=</span> <span class="n">connect_timeout</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">socket_url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{root}</span><span class="s2">?api_key=</span><span class="si">{api_key}</span><span class="s2">&quot;</span>\
        <span class="s2">&quot;&amp;access_token=</span><span class="si">{access_token}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span>
            <span class="n">api_key</span><span class="o">=</span><span class="n">api_key</span><span class="p">,</span>
            <span class="n">access_token</span><span class="o">=</span><span class="n">access_token</span>
        <span class="p">)</span>
    <span class="c1"># Debug enables logs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
    <span class="c1"># Placeholders for callbacks.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_ticks</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_close</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_error</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_connect</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_message</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_reconnect</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_noreconnect</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Text message updates</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">on_order_update</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># List of current subscribed tokens</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">subscribed_tokens</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteTicker.close">
    <p>def <span class="ident">close</span>(</p><p>self, code=None, reason=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Close the WebSocket connection.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteTicker.close', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteTicker.close" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Close the WebSocket connection.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stop_retry</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">reason</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteTicker.connect">
    <p>def <span class="ident">connect</span>(</p><p>self, threaded=False, disable_ssl_verification=False, proxy=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Establish a websocket connection.</p>
<ul>
<li><code>threaded</code> is a boolean indicating if the websocket client has to be run in threaded mode or not</li>
<li><code>disable_ssl_verification</code> disables building ssl context</li>
<li><code>proxy</code> is a dictionary with keys <code>host</code> and <code>port</code> which denotes the proxy settings</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteTicker.connect', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteTicker.connect" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threaded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">disable_ssl_verification</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">proxy</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Establish a websocket connection.</span>
<span class="sd">    - `threaded` is a boolean indicating if the websocket client has to be run in threaded mode or not</span>
<span class="sd">    - `disable_ssl_verification` disables building ssl context</span>
<span class="sd">    - `proxy` is a dictionary with keys `host` and `port` which denotes the proxy settings</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Custom headers</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;X-Kite-Version&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>  <span class="c1"># For version 3</span>
    <span class="p">}</span>
    <span class="c1"># Init WebSocket client factory</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_create_connection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">socket_url</span><span class="p">,</span>
                            <span class="n">useragent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_user_agent</span><span class="p">(),</span>
                            <span class="n">proxy</span><span class="o">=</span><span class="n">proxy</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="c1"># Set SSL context</span>
    <span class="n">context_factory</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">isSecure</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">disable_ssl_verification</span><span class="p">:</span>
        <span class="n">context_factory</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">ClientContextFactory</span><span class="p">()</span>
    <span class="c1"># Establish WebSocket connection to a server</span>
    <span class="n">connectWS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="p">,</span> <span class="n">contextFactory</span><span class="o">=</span><span class="n">context_factory</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connect_timeout</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
        <span class="n">twisted_log</span><span class="o">.</span><span class="n">startLogging</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
    <span class="c1"># Run in seperate thread of blocking</span>
    <span class="n">opts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Run when reactor is not running</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">reactor</span><span class="o">.</span><span class="n">running</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">threaded</span><span class="p">:</span>
            <span class="c1"># Signals are not allowed in non main thread by twisted so suppress it.</span>
            <span class="n">opts</span><span class="p">[</span><span class="s2">&quot;installSignalHandlers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">websocket_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">reactor</span><span class="o">.</span><span class="n">run</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">opts</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">websocket_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">websocket_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reactor</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="o">**</span><span class="n">opts</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteTicker.is_connected">
    <p>def <span class="ident">is_connected</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Check if WebSocket connection is established.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteTicker.is_connected', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteTicker.is_connected" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if WebSocket connection is established.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">STATE_OPEN</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteTicker.resubscribe">
    <p>def <span class="ident">resubscribe</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Resubscribe to all current subscribed tokens.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteTicker.resubscribe', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteTicker.resubscribe" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">resubscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Resubscribe to all current subscribed tokens.&quot;&quot;&quot;</span>
    <span class="n">modes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subscribed_tokens</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subscribed_tokens</span><span class="p">[</span><span class="n">token</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">modes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="n">modes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">modes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Resubscribe and set mode: </span><span class="si">{}</span><span class="s2"> - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">modes</span><span class="p">[</span><span class="n">mode</span><span class="p">])</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteTicker.set_mode">
    <p>def <span class="ident">set_mode</span>(</p><p>self, mode, instrument_tokens)</p>
    </div>
    

    
  
    <div class="desc"><p>Set streaming mode for the given list of tokens.</p>
<ul>
<li><code>mode</code> is the mode to set. It can be one of the following class constants:
    MODE_LTP, MODE_QUOTE, or MODE_FULL.</li>
<li><code>instrument_tokens</code> is list of instrument tokens on which the mode should be applied</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteTicker.set_mode', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteTicker.set_mode" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">instrument_tokens</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set streaming mode for the given list of tokens.</span>
<span class="sd">    - `mode` is the mode to set. It can be one of the following class constants:</span>
<span class="sd">        MODE_LTP, MODE_QUOTE, or MODE_FULL.</span>
<span class="sd">    - `instrument_tokens` is list of instrument tokens on which the mode should be applied</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_setmode</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">instrument_tokens</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span>
            <span class="n">six</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_setmode</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">mode</span><span class="p">,</span> <span class="n">instrument_tokens</span><span class="p">]}))</span>
        <span class="p">)</span>
        <span class="c1"># Update modes</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">instrument_tokens</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subscribed_tokens</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Error while setting mode: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
        <span class="k">raise</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteTicker.stop">
    <p>def <span class="ident">stop</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Stop the event loop. Should be used if main thread has to be closed in <code>on_close</code> method.
Reconnection mechanism cannot happen past this method</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteTicker.stop', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteTicker.stop" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Stop the event loop. Should be used if main thread has to be closed in `on_close` method.</span>
<span class="sd">    Reconnection mechanism cannot happen past this method</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reactor</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteTicker.stop_retry">
    <p>def <span class="ident">stop_retry</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Stop auto retry when it is in progress.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteTicker.stop_retry', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteTicker.stop_retry" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">stop_retry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Stop auto retry when it is in progress.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">stopTrying</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteTicker.subscribe">
    <p>def <span class="ident">subscribe</span>(</p><p>self, instrument_tokens)</p>
    </div>
    

    
  
    <div class="desc"><p>Subscribe to a list of instrument_tokens.</p>
<ul>
<li><code>instrument_tokens</code> is list of instrument instrument_tokens to subscribe</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteTicker.subscribe', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteTicker.subscribe" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">subscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instrument_tokens</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Subscribe to a list of instrument_tokens.</span>
<span class="sd">    - `instrument_tokens` is list of instrument instrument_tokens to subscribe</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;called&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_subscribe</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span>
            <span class="n">six</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_subscribe</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="n">instrument_tokens</span><span class="p">}))</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">instrument_tokens</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subscribed_tokens</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MODE_QUOTE</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Error while subscribe: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
        <span class="k">raise</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="kiteconnect.KiteTicker.unsubscribe">
    <p>def <span class="ident">unsubscribe</span>(</p><p>self, instrument_tokens)</p>
    </div>
    

    
  
    <div class="desc"><p>Unsubscribe the given list of instrument_tokens.</p>
<ul>
<li><code>instrument_tokens</code> is list of instrument_tokens to unsubscribe.</li>
</ul></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-kiteconnect.KiteTicker.unsubscribe', this);">Show source &equiv;</a></p>
  <div id="source-kiteconnect.KiteTicker.unsubscribe" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instrument_tokens</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unsubscribe the given list of instrument_tokens.</span>
<span class="sd">    - `instrument_tokens` is list of instrument_tokens to unsubscribe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">sendMessage</span><span class="p">(</span>
            <span class="n">six</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_unsubscribe</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="n">instrument_tokens</span><span class="p">}))</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">instrument_tokens</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">del</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subscribed_tokens</span><span class="p">[</span><span class="n">token</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Error while unsubscribe: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
        <span class="k">raise</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="kiteconnect.KiteTicker.connect_timeout" class="name">var <span class="ident">connect_timeout</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.debug" class="name">var <span class="ident">debug</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.on_close" class="name">var <span class="ident">on_close</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.on_connect" class="name">var <span class="ident">on_connect</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.on_error" class="name">var <span class="ident">on_error</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.on_message" class="name">var <span class="ident">on_message</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.on_noreconnect" class="name">var <span class="ident">on_noreconnect</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.on_open" class="name">var <span class="ident">on_open</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.on_order_update" class="name">var <span class="ident">on_order_update</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.on_reconnect" class="name">var <span class="ident">on_reconnect</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.on_ticks" class="name">var <span class="ident">on_ticks</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.root" class="name">var <span class="ident">root</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.socket_url" class="name">var <span class="ident">socket_url</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="kiteconnect.KiteTicker.subscribed_tokens" class="name">var <span class="ident">subscribed_tokens</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>

    <h2 class="section-title" id="header-submodules">Sub-modules</h2>
      <div class="item">
      <p class="name"><a href="exceptions.m.html">kiteconnect.exceptions</a></p>
      
  
    <div class="desc"><p>exceptions.py</p>
<p>Exceptions raised by the Kite Connect client.</p>
<p>:copyright: (c) 2017 by Zerodha Technology.
:license: see LICENSE for details.</p></div>

      </div>
  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
